{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "4a1417fe-d1ee-40ed-9a72-52b81210ad0b",
   "metadata": {},
   "outputs": [],
   "source": [
    "from mech_int.neel_digits import *"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "07b46245-70e4-48ff-a379-a9cb76e3b480",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fri Jun  9 18:08:12 2023       \n",
      "+-----------------------------------------------------------------------------+\n",
      "| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n",
      "|-------------------------------+----------------------+----------------------+\n",
      "| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n",
      "| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n",
      "|                               |                      |               MIG M. |\n",
      "|===============================+======================+======================|\n",
      "|   0  NVIDIA A10G         On   | 00000000:00:1E.0 Off |                    0 |\n",
      "|  0%   25C    P8    15W / 300W |      2MiB / 23028MiB |      0%      Default |\n",
      "|                               |                      |                  N/A |\n",
      "+-------------------------------+----------------------+----------------------+\n",
      "                                                                               \n",
      "+-----------------------------------------------------------------------------+\n",
      "| Processes:                                                                  |\n",
      "|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n",
      "|        ID   ID                                                   Usage      |\n",
      "|=============================================================================|\n",
      "|  No running processes found                                                 |\n",
      "+-----------------------------------------------------------------------------+\n"
     ]
    }
   ],
   "source": [
    "!nvidia-smi"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f4d845f0-90b0-4fe4-82b7-0dbe660409fc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "creating new model d_model=512 d_mlp=2048 d_head=128 num_layers=1 num_heads=4\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "7373d8a75115405196635c062ad38b83",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/3000 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 loss=2.6105819786265503 accuracy=0.0703125\n",
      "100 loss=2.0057420168628504 accuracy=0.21354166666666666\n",
      "200 loss=2.0135288671672305 accuracy=0.21875\n",
      "300 loss=1.8893141949997951 accuracy=0.2864583333333333\n",
      "400 loss=1.8036568542972227 accuracy=0.3307291666666667\n",
      "500 loss=1.7227022578339968 accuracy=0.3203125\n",
      "600 loss=1.689145694215882 accuracy=0.359375\n",
      "700 loss=1.6665281152252631 accuracy=0.3489583333333333\n",
      "800 loss=1.6313435205228366 accuracy=0.3854166666666667\n",
      "900 loss=1.609152815256432 accuracy=0.375\n",
      "1000 loss=1.4916995217260365 accuracy=0.4739583333333333\n",
      "1100 loss=1.363406567383182 accuracy=0.4765625\n",
      "1200 loss=1.3620962615118364 accuracy=0.4661458333333333\n",
      "1300 loss=1.3071074406213694 accuracy=0.4895833333333333\n",
      "1400 loss=1.1719613816507193 accuracy=0.5598958333333334\n",
      "1500 loss=1.006905794605581 accuracy=0.5989583333333334\n",
      "1600 loss=0.6873556757828384 accuracy=0.7161458333333334\n",
      "1700 loss=0.4011668117694157 accuracy=0.8098958333333334\n",
      "1800 loss=0.276118779531634 accuracy=0.8828125\n",
      "1900 loss=0.22291224763543532 accuracy=0.8958333333333334\n",
      "2000 loss=0.1363681203126206 accuracy=0.953125\n",
      "2100 loss=0.1112253413490873 accuracy=0.9557291666666666\n",
      "2200 loss=0.06422957954176096 accuracy=0.9817708333333334\n",
      "2300 loss=0.09080105198404849 accuracy=0.9635416666666666\n",
      "2400 loss=0.05550436347873383 accuracy=0.9739583333333334\n",
      "2500 loss=0.0400728368744749 accuracy=0.984375\n",
      "2600 loss=0.07029075009406983 accuracy=0.9765625\n",
      "2700 loss=0.0773214672172697 accuracy=0.9765625\n",
      "2800 loss=0.045800390137620065 accuracy=0.9869791666666666\n",
      "2900 loss=0.051629052384553294 accuracy=0.9713541666666666\n",
      "epoch=2999 loss=0.03578052083112304 per_token_losses=tensor([0.0016, 0.0234, 0.0498, 0.1253, 0.0142, 0.0004], dtype=torch.float64) accuracy=0.9922 per_token_accuracy=array([1.      , 1.      , 0.984375, 0.96875 , 1.      , 1.      ])\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "9af080739c6c47f1a9ec17dcdb1d6445",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'hovertemplate': 'variable=0<br>index=%{x}<br>value=%{y}<extra></extra>',\n",
       "              'legendgroup': '0',\n",
       "              'line': {'color': '#636efa', 'dash': 'solid'},\n",
       "              'marker': {'symbol': 'circle'},\n",
       "              'mode': 'lines',\n",
       "              'name': '0',\n",
       "              'showlegend': True,\n",
       "              'type': 'scattergl',\n",
       "              'uid': '306b527e-77b6-42e4-981f-d0ba36a670cb',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'xaxis': 'x',\n",
       "              'y': array([2.61058198, 2.60486583, 2.53236704, ..., 0.01885485, 0.04679556,\n",
       "                          0.03578052]),\n",
       "              'yaxis': 'y'}],\n",
       "    'layout': {'legend': {'title': {'text': 'variable'}, 'tracegroupgap': 0},\n",
       "               'template': '...',\n",
       "               'title': {'text': 'train loss'},\n",
       "               'xaxis': {'anchor': 'y', 'domain': [0.0, 1.0], 'title': {'text': ''}},\n",
       "               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': ''}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "bc5f2fdc272e45df91d56f878188decd",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': '7a98c550-c1a0-468b-9cc3-342404f7c59a',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.50865447e+00, 2.51918500e+00, 2.44547328e+00, ..., 1.92515954e-02,\n",
       "                          4.69583453e-02, 1.63312290e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': '1b2d1245-33f1-47e3-81d4-255658bb8618',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.52469248, 2.52158983, 2.49167904, ..., 0.04001817, 0.08288465,\n",
       "                          0.02335755])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'fa56c0c1-a3eb-4598-be51-504d38d8a8c4',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.86560697, 2.87291395, 2.69877434, ..., 0.01957206, 0.10838801,\n",
       "                          0.04976543])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'ba6dc8c9-f7ac-4313-82d5-8b6cfb64eed6',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.5199643 , 2.48442776, 2.38000414, ..., 0.02280052, 0.01743527,\n",
       "                          0.12526765])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'e310fd6e-afad-4794-8576-371e3e3c5aa2',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.65607999, 2.60996518, 2.64044764, ..., 0.01082104, 0.02431686,\n",
       "                          0.01423288])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': '2d523d77-c340-4eb2-9cc3-5a1e864e1bb2',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.58849367e+00, 2.62111326e+00, 2.53782381e+00, ..., 6.65724009e-04,\n",
       "                          7.90209756e-04, 4.26492580e-04])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': '1a4578a6-46e7-4e09-b4e7-bf6cd302a45a',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': [2.6105819786265503, 2.604865827420149, 2.5323670415622064,\n",
       "                    ..., 0.01885485260788637, 0.046795556429218385,\n",
       "                    0.03578052083112304]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data)'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'Loss'}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "20ad1ca8d13145ca9a4e3549aeb51aba",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': '32317c24-0b36-424a-bd49-6f495bff2059',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.50865447e+00, 2.51918500e+00, 2.44547328e+00, ..., 1.92515954e-02,\n",
       "                          4.69583453e-02, 1.63312290e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'a61a3575-9e6b-48a0-bdaa-ee994f778b2a',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.52469248, 2.52158983, 2.49167904, ..., 0.04001817, 0.08288465,\n",
       "                          0.02335755])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': '56cf0cc6-ad2f-4ec4-afbf-e45a29427050',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.86560697, 2.87291395, 2.69877434, ..., 0.01957206, 0.10838801,\n",
       "                          0.04976543])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': '2d2c32e1-4f79-4f22-ab39-20f9f058c5f2',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.5199643 , 2.48442776, 2.38000414, ..., 0.02280052, 0.01743527,\n",
       "                          0.12526765])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'c392ce0f-08bf-45cc-b3a6-e781aba688f5',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.65607999, 2.60996518, 2.64044764, ..., 0.01082104, 0.02431686,\n",
       "                          0.01423288])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'a615415e-9b71-4b50-8c18-dddbf1124e20',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': array([2.58849367e+00, 2.62111326e+00, 2.53782381e+00, ..., 6.65724009e-04,\n",
       "                          7.90209756e-04, 4.26492580e-04])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': '13cab7f5-9a34-42dd-9702-d85715d4466c',\n",
       "              'x': array([   0,    1,    2, ..., 2997, 2998, 2999]),\n",
       "              'y': [2.6105819786265503, 2.604865827420149, 2.5323670415622064,\n",
       "                    ..., 0.01885485260788637, 0.046795556429218385,\n",
       "                    0.03578052083112304]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data) - Log Y Axis'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'log Loss'}, 'type': 'log'}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "train(is_finite=False, d_model=512, d_mlp=2048, num_epochs=3_000, checkpoint_every=100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "a78036aa-3347-47b0-8490-9e075b042f4c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "creating new model d_model=512 d_mlp=2048 d_head=128 num_layers=1 num_heads=4\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "7d64ac870cbd43a2af584bdc30bd05c1",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/20000 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 loss=2.6105819786265503 accuracy=0.0703125\n",
      "100 loss=2.0057420168628504 accuracy=0.21354166666666666\n",
      "200 loss=2.0135288671672305 accuracy=0.21875\n",
      "300 loss=1.8893141949997951 accuracy=0.2864583333333333\n",
      "400 loss=1.8036568542972227 accuracy=0.3307291666666667\n",
      "500 loss=1.7227022578339968 accuracy=0.3203125\n",
      "600 loss=1.689145694215882 accuracy=0.359375\n",
      "700 loss=1.6665281152252631 accuracy=0.3489583333333333\n",
      "800 loss=1.6313435205228366 accuracy=0.3854166666666667\n",
      "900 loss=1.609152815256432 accuracy=0.375\n",
      "1000 loss=1.4916995217260365 accuracy=0.4739583333333333\n",
      "1100 loss=1.363406567383182 accuracy=0.4765625\n",
      "1200 loss=1.3620962615118364 accuracy=0.4661458333333333\n",
      "1300 loss=1.3071074406213694 accuracy=0.4895833333333333\n",
      "1400 loss=1.1719613816507193 accuracy=0.5598958333333334\n",
      "1500 loss=1.006905794605581 accuracy=0.5989583333333334\n",
      "1600 loss=0.6873556757828384 accuracy=0.7161458333333334\n",
      "1700 loss=0.4011668117694157 accuracy=0.8098958333333334\n",
      "1800 loss=0.276118779531634 accuracy=0.8828125\n",
      "1900 loss=0.22291224763543532 accuracy=0.8958333333333334\n",
      "2000 loss=0.1363681203126206 accuracy=0.953125\n",
      "2100 loss=0.1112253413490873 accuracy=0.9557291666666666\n",
      "2200 loss=0.06422957954176096 accuracy=0.9817708333333334\n",
      "2300 loss=0.09080105198404849 accuracy=0.9635416666666666\n",
      "2400 loss=0.05550436347873383 accuracy=0.9739583333333334\n",
      "2500 loss=0.0400728368744749 accuracy=0.984375\n",
      "2600 loss=0.07029075009406983 accuracy=0.9765625\n",
      "2700 loss=0.0773214672172697 accuracy=0.9765625\n",
      "2800 loss=0.045800390137620065 accuracy=0.9869791666666666\n",
      "2900 loss=0.051629052384553294 accuracy=0.9713541666666666\n",
      "3000 loss=0.04181670061988281 accuracy=0.9765625\n",
      "3100 loss=0.034155801594148286 accuracy=0.9869791666666666\n",
      "3200 loss=0.0422474747514092 accuracy=0.984375\n",
      "3300 loss=0.04176774487031561 accuracy=0.9817708333333334\n",
      "3400 loss=0.019721596950307476 accuracy=0.9921875\n",
      "3500 loss=0.05310542033040176 accuracy=0.9817708333333334\n",
      "3600 loss=0.020024464547128123 accuracy=0.9921875\n",
      "3700 loss=0.04156353953694898 accuracy=0.984375\n",
      "3800 loss=0.022532580746123063 accuracy=0.9895833333333334\n",
      "3900 loss=0.03739102087924771 accuracy=0.9869791666666666\n",
      "4000 loss=0.025254245980577093 accuracy=0.9921875\n",
      "4100 loss=0.032524985000427095 accuracy=0.9817708333333334\n",
      "4200 loss=0.031174529083199093 accuracy=0.984375\n",
      "4300 loss=0.040585311047721125 accuracy=0.9921875\n",
      "4400 loss=0.022629705120854555 accuracy=0.9921875\n",
      "4500 loss=0.017630053134441624 accuracy=0.9921875\n",
      "4600 loss=0.02862703075666082 accuracy=0.9895833333333334\n",
      "4700 loss=0.03558041134353145 accuracy=0.9895833333333334\n",
      "4800 loss=0.020475885518748446 accuracy=0.9895833333333334\n",
      "4900 loss=0.02278635884145245 accuracy=0.9921875\n",
      "5000 loss=0.028413220033725622 accuracy=0.9895833333333334\n",
      "5100 loss=0.05198886161434757 accuracy=0.984375\n",
      "5200 loss=0.01858394474902449 accuracy=0.9973958333333334\n",
      "5300 loss=0.03906544108654636 accuracy=0.9869791666666666\n",
      "5400 loss=0.017601719640781742 accuracy=0.9921875\n",
      "5500 loss=0.03111623750218447 accuracy=0.9869791666666666\n",
      "5600 loss=0.01957449005426596 accuracy=0.9895833333333334\n",
      "5700 loss=0.012177237793918253 accuracy=0.9947916666666666\n",
      "5800 loss=0.024771175306339533 accuracy=0.9895833333333334\n",
      "5900 loss=0.028025184638316734 accuracy=0.9895833333333334\n",
      "6000 loss=0.019021111483452764 accuracy=0.9921875\n",
      "6100 loss=0.03634432570566987 accuracy=0.984375\n",
      "6200 loss=0.02360228852176501 accuracy=0.9921875\n",
      "6300 loss=0.03304474138748663 accuracy=0.9895833333333334\n",
      "6400 loss=0.0036167206311785343 accuracy=1.0\n",
      "6500 loss=0.029865109841562362 accuracy=0.9869791666666666\n",
      "6600 loss=0.013385422181442234 accuracy=0.9947916666666666\n",
      "6700 loss=0.03776490693221659 accuracy=0.984375\n",
      "6800 loss=0.017773533009390774 accuracy=0.9895833333333334\n",
      "6900 loss=0.0200994871286492 accuracy=0.9947916666666666\n",
      "7000 loss=0.03116686098550129 accuracy=0.9895833333333334\n",
      "7100 loss=0.01609041146574243 accuracy=0.9921875\n",
      "7200 loss=0.026277514825698595 accuracy=0.9921875\n",
      "7300 loss=0.019958769584635848 accuracy=0.9921875\n",
      "7400 loss=0.026250334321449426 accuracy=0.9895833333333334\n",
      "7500 loss=0.006320359233573816 accuracy=0.9973958333333334\n",
      "7600 loss=0.013237160993868756 accuracy=0.9921875\n",
      "7700 loss=0.024199431927113935 accuracy=0.9895833333333334\n",
      "7800 loss=0.03138253444645029 accuracy=0.9869791666666666\n",
      "7900 loss=0.02083226131993616 accuracy=0.9921875\n",
      "8000 loss=0.020728018686131625 accuracy=0.9895833333333334\n",
      "8100 loss=0.01921721966947111 accuracy=0.9921875\n",
      "8200 loss=0.019642888861749353 accuracy=0.9895833333333334\n",
      "8300 loss=0.009843048226919157 accuracy=0.9973958333333334\n",
      "8400 loss=0.03970963220829303 accuracy=0.984375\n",
      "8500 loss=0.01476014698844347 accuracy=0.9973958333333334\n",
      "8600 loss=0.020406083992701118 accuracy=0.9921875\n",
      "8700 loss=0.038612599408942246 accuracy=0.9869791666666666\n",
      "8800 loss=0.00505440349087176 accuracy=1.0\n",
      "8900 loss=0.02880882176179209 accuracy=0.9869791666666666\n",
      "9000 loss=0.010646691946346352 accuracy=0.9973958333333334\n",
      "9100 loss=0.0051104228951592435 accuracy=0.9973958333333334\n",
      "9200 loss=0.02164464424430016 accuracy=0.9895833333333334\n",
      "9300 loss=0.020039405895312848 accuracy=0.9921875\n",
      "9400 loss=0.006641929688532765 accuracy=1.0\n",
      "9500 loss=0.03466881804427867 accuracy=0.9869791666666666\n",
      "9600 loss=0.007622209857775537 accuracy=0.9973958333333334\n",
      "9700 loss=0.03515957927985021 accuracy=0.9869791666666666\n",
      "9800 loss=0.006185622273014717 accuracy=0.9973958333333334\n",
      "9900 loss=0.010824662660958703 accuracy=0.9947916666666666\n",
      "10000 loss=0.026655063640661093 accuracy=0.9895833333333334\n",
      "10100 loss=0.020393766835732498 accuracy=0.9921875\n",
      "10200 loss=0.014500485277902639 accuracy=0.9921875\n",
      "10300 loss=0.007602134932277391 accuracy=0.9947916666666666\n",
      "10400 loss=0.007831049990782749 accuracy=0.9973958333333334\n",
      "10500 loss=0.013928216235065885 accuracy=0.9947916666666666\n",
      "10600 loss=0.021823722068768776 accuracy=0.9921875\n",
      "10700 loss=0.010815503744641084 accuracy=0.9921875\n",
      "10800 loss=0.005530621363981388 accuracy=1.0\n",
      "10900 loss=0.01817994566192379 accuracy=0.9947916666666666\n",
      "11000 loss=0.004322423051573172 accuracy=1.0\n",
      "11100 loss=0.015438241984071711 accuracy=0.9947916666666666\n",
      "11200 loss=0.0160938564205026 accuracy=0.9921875\n",
      "11300 loss=0.026293682191490628 accuracy=0.9869791666666666\n",
      "11400 loss=0.030913809002513372 accuracy=0.9921875\n",
      "11500 loss=0.016274096013109276 accuracy=0.9921875\n",
      "11600 loss=0.011108773836475589 accuracy=0.9921875\n",
      "11700 loss=0.015529853216854642 accuracy=0.9921875\n",
      "11800 loss=0.016643587559012463 accuracy=0.9947916666666666\n",
      "11900 loss=0.005128277863010834 accuracy=1.0\n",
      "12000 loss=0.03399959895131755 accuracy=0.9895833333333334\n",
      "12100 loss=0.010697871697311978 accuracy=0.9973958333333334\n",
      "12200 loss=0.009457690502782118 accuracy=0.9973958333333334\n",
      "12300 loss=0.011858835843461337 accuracy=0.9947916666666666\n",
      "12400 loss=0.025185586234852127 accuracy=0.9895833333333334\n",
      "12500 loss=0.036078210109678835 accuracy=0.9895833333333334\n",
      "12600 loss=0.00494835791973858 accuracy=0.9973958333333334\n",
      "12700 loss=0.008686810540888152 accuracy=0.9973958333333334\n",
      "12800 loss=0.017218901760768773 accuracy=0.9947916666666666\n",
      "12900 loss=0.0023103462492985232 accuracy=1.0\n",
      "13000 loss=0.016941775903080922 accuracy=0.9921875\n",
      "13100 loss=0.018318296750770804 accuracy=0.9947916666666666\n",
      "13200 loss=0.016610074779126256 accuracy=0.9921875\n",
      "13300 loss=0.008779225211662823 accuracy=0.9973958333333334\n",
      "13400 loss=0.022741619955624032 accuracy=0.9921875\n",
      "13500 loss=0.022431525978443584 accuracy=0.9895833333333334\n",
      "13600 loss=0.013866329045787044 accuracy=0.9921875\n",
      "13700 loss=0.010410253020537002 accuracy=0.9947916666666666\n",
      "13800 loss=0.03863295721135272 accuracy=0.9869791666666666\n",
      "13900 loss=0.021111029146789258 accuracy=0.9947916666666666\n",
      "14000 loss=0.008309291684862767 accuracy=0.9947916666666666\n",
      "14100 loss=0.020283731447300408 accuracy=0.9895833333333334\n",
      "14200 loss=0.014770150459774306 accuracy=0.9947916666666666\n",
      "14300 loss=0.00968340120250138 accuracy=0.9973958333333334\n",
      "14400 loss=0.031080630770265134 accuracy=0.9869791666666666\n",
      "14500 loss=0.022791783499482174 accuracy=0.9869791666666666\n",
      "14600 loss=0.01639820435687441 accuracy=0.9947916666666666\n",
      "14700 loss=0.010199194487702642 accuracy=0.9947916666666666\n",
      "14800 loss=0.012322572600113055 accuracy=0.9947916666666666\n",
      "14900 loss=0.007267872522865406 accuracy=0.9973958333333334\n",
      "15000 loss=0.005306837373155062 accuracy=0.9973958333333334\n",
      "15100 loss=0.005006021266972682 accuracy=0.9973958333333334\n",
      "15200 loss=0.010327657953691873 accuracy=0.9947916666666666\n",
      "15300 loss=0.011762865021665356 accuracy=0.9947916666666666\n",
      "15400 loss=0.028895985902863245 accuracy=0.984375\n",
      "15500 loss=0.018501851636588233 accuracy=0.9895833333333334\n",
      "15600 loss=0.011369776513306746 accuracy=0.9947916666666666\n",
      "15700 loss=0.008935432128806644 accuracy=0.9973958333333334\n",
      "15800 loss=0.01564874188430926 accuracy=0.9895833333333334\n",
      "15900 loss=0.01728663239221423 accuracy=0.9921875\n",
      "16000 loss=0.00294910124986704 accuracy=1.0\n",
      "16100 loss=0.009029919517535722 accuracy=0.9921875\n",
      "16200 loss=0.010706415204642642 accuracy=0.9973958333333334\n",
      "16300 loss=0.013016283830647134 accuracy=0.9921875\n",
      "16400 loss=0.023243891533949596 accuracy=0.9895833333333334\n",
      "16500 loss=0.02054451796126723 accuracy=0.9921875\n",
      "16600 loss=0.00788320753324019 accuracy=0.9973958333333334\n",
      "16700 loss=0.0056564682172662 accuracy=1.0\n",
      "16800 loss=0.01155788941470242 accuracy=0.9947916666666666\n",
      "16900 loss=0.017918134300351427 accuracy=0.9947916666666666\n",
      "17000 loss=0.004278725270359382 accuracy=0.9973958333333334\n",
      "17100 loss=0.01306779654718163 accuracy=0.9947916666666666\n",
      "17200 loss=0.015955602973806264 accuracy=0.9947916666666666\n",
      "17300 loss=0.01734618429546193 accuracy=0.9947916666666666\n",
      "17400 loss=0.0325512350287369 accuracy=0.9895833333333334\n",
      "17500 loss=0.01608393975561103 accuracy=0.9947916666666666\n",
      "17600 loss=0.007202985013283648 accuracy=0.9973958333333334\n",
      "17700 loss=0.020244052655805964 accuracy=0.9973958333333334\n",
      "17800 loss=0.010089066461349881 accuracy=0.9947916666666666\n",
      "17900 loss=0.004726958109267813 accuracy=0.9973958333333334\n",
      "18000 loss=0.022292610666073798 accuracy=0.9921875\n",
      "18100 loss=0.017759999629321864 accuracy=0.9895833333333334\n",
      "18200 loss=0.03131275061012358 accuracy=0.9869791666666666\n",
      "18300 loss=0.021622418209635456 accuracy=0.9895833333333334\n",
      "18400 loss=0.013259976020382857 accuracy=0.9921875\n",
      "18500 loss=0.020433969642781342 accuracy=0.9921875\n",
      "18600 loss=0.0031518017153128065 accuracy=1.0\n",
      "18700 loss=0.013035870460894203 accuracy=0.9947916666666666\n",
      "18800 loss=0.00915187025195097 accuracy=0.9973958333333334\n",
      "18900 loss=0.023475123968602962 accuracy=0.9895833333333334\n",
      "19000 loss=0.013632395722656274 accuracy=0.9947916666666666\n",
      "19100 loss=0.03707544220019629 accuracy=0.984375\n",
      "19200 loss=0.006024462778688887 accuracy=0.9973958333333334\n",
      "19300 loss=0.007554112659494093 accuracy=0.9973958333333334\n",
      "19400 loss=0.006545849296834577 accuracy=0.9973958333333334\n",
      "19500 loss=0.008774155672861324 accuracy=0.9947916666666666\n",
      "19600 loss=0.007983197938191362 accuracy=0.9947916666666666\n",
      "19700 loss=0.009403264111049286 accuracy=0.9921875\n",
      "19800 loss=0.017590804492704514 accuracy=0.9895833333333334\n",
      "19900 loss=0.006190140301104182 accuracy=0.9973958333333334\n",
      "epoch=19999 loss=0.006240746838859367 per_token_losses=tensor([2.6959e-04, 1.5644e-03, 9.2699e-03, 2.6152e-02, 1.8299e-04, 5.0898e-06],\n",
      "       dtype=torch.float64) accuracy=0.9974 per_token_accuracy=array([1.      , 1.      , 1.      , 0.984375, 1.      , 1.      ])\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "6636ca3ad17c4458a7efaf30380279e9",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'hovertemplate': 'variable=0<br>index=%{x}<br>value=%{y}<extra></extra>',\n",
       "              'legendgroup': '0',\n",
       "              'line': {'color': '#636efa', 'dash': 'solid'},\n",
       "              'marker': {'symbol': 'circle'},\n",
       "              'mode': 'lines',\n",
       "              'name': '0',\n",
       "              'showlegend': True,\n",
       "              'type': 'scattergl',\n",
       "              'uid': '4f5bd081-78d5-4795-a8df-b2671e67ffdc',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'xaxis': 'x',\n",
       "              'y': array([2.61058198, 2.60486583, 2.53236704, ..., 0.00986852, 0.00836343,\n",
       "                          0.00624075]),\n",
       "              'yaxis': 'y'}],\n",
       "    'layout': {'legend': {'title': {'text': 'variable'}, 'tracegroupgap': 0},\n",
       "               'template': '...',\n",
       "               'title': {'text': 'train loss'},\n",
       "               'xaxis': {'anchor': 'y', 'domain': [0.0, 1.0], 'title': {'text': ''}},\n",
       "               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': ''}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "ef495f30dd534cdb83f90ccc5dfd0c1f",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'ad0a9c48-4828-4678-97a7-8904cdea70df',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.50865447e+00, 2.51918500e+00, 2.44547328e+00, ..., 1.93313526e-04,\n",
       "                          3.65039621e-05, 2.69589954e-04])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'b03a6317-6c74-4da2-91ce-a973327a6221',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.52469248e+00, 2.52158983e+00, 2.49167904e+00, ..., 1.49222573e-03,\n",
       "                          4.55093449e-02, 1.56440438e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'c4a2db2a-980b-444d-9bae-0ce0609ef2b4',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.86560697e+00, 2.87291395e+00, 2.69877434e+00, ..., 7.06882000e-04,\n",
       "                          1.32400102e-03, 9.26990947e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': '0a0709ac-b6e8-4f75-b4b2-66db792667fb',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.5199643 , 2.48442776, 2.38000414, ..., 0.05658071, 0.00319055,\n",
       "                          0.0261525 ])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': '1b0dad93-51c0-459e-b34d-04f8a3548428',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.65607999e+00, 2.60996518e+00, 2.64044764e+00, ..., 2.33174344e-04,\n",
       "                          1.11956450e-04, 1.82988813e-04])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': '9a9a8a87-3a33-4d7b-b07f-9e4c6ae6ecbb',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.58849367e+00, 2.62111326e+00, 2.53782381e+00, ..., 4.82360548e-06,\n",
       "                          8.20083363e-06, 5.08982242e-06])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': '344bb7c4-d811-4916-b6de-5b78736cba84',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': [2.6105819786265503, 2.604865827420149, 2.5323670415622064,\n",
       "                    ..., 0.009868521841296484, 0.008363425717229448,\n",
       "                    0.006240746838859367]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data)'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'Loss'}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "0695ceb14d6a4b49883ef769e5e7c691",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': '6ee5fe81-8485-46d3-a18b-0c4277c78c7d',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.50865447e+00, 2.51918500e+00, 2.44547328e+00, ..., 1.93313526e-04,\n",
       "                          3.65039621e-05, 2.69589954e-04])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': '368c1328-1dda-45dc-9af7-bb2f6f36f02f',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.52469248e+00, 2.52158983e+00, 2.49167904e+00, ..., 1.49222573e-03,\n",
       "                          4.55093449e-02, 1.56440438e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'f2a97ee9-2b1b-42e5-9b0e-f1ea59949a21',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.86560697e+00, 2.87291395e+00, 2.69877434e+00, ..., 7.06882000e-04,\n",
       "                          1.32400102e-03, 9.26990947e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': '0417df1d-318f-447f-a514-899b0ce0e53e',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.5199643 , 2.48442776, 2.38000414, ..., 0.05658071, 0.00319055,\n",
       "                          0.0261525 ])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': '35af009c-2c67-435a-8e25-39a86604894f',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.65607999e+00, 2.60996518e+00, 2.64044764e+00, ..., 2.33174344e-04,\n",
       "                          1.11956450e-04, 1.82988813e-04])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': '26b7712d-8b0f-40a7-a2b1-36f2d2421066',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.58849367e+00, 2.62111326e+00, 2.53782381e+00, ..., 4.82360548e-06,\n",
       "                          8.20083363e-06, 5.08982242e-06])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': '669ff4d6-ee8f-4921-98b7-60d1edab9956',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': [2.6105819786265503, 2.604865827420149, 2.5323670415622064,\n",
       "                    ..., 0.009868521841296484, 0.008363425717229448,\n",
       "                    0.006240746838859367]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data) - Log Y Axis'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'log Loss'}, 'type': 'log'}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "train(is_finite=False, d_model=512, d_mlp=2048, num_epochs=20_000, checkpoint_every=1000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "2d46c678-00e3-4733-bc99-0af8720f3a17",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "creating new model d_model=256 d_mlp=256 d_head=64 num_layers=1 num_heads=4\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "bdd54caf3c6540e7bc8e664356568d48",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/20000 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 loss=2.4934891781276076 accuracy=0.078125\n",
      "100 loss=2.0096481129977666 accuracy=0.1875\n",
      "200 loss=1.9876317234108951 accuracy=0.21614583333333334\n",
      "300 loss=1.9696065704975934 accuracy=0.2265625\n",
      "400 loss=1.9361047554169786 accuracy=0.2578125\n",
      "500 loss=1.887949156649673 accuracy=0.2916666666666667\n",
      "600 loss=1.890686113684422 accuracy=0.23958333333333334\n",
      "700 loss=1.8389690862517876 accuracy=0.2890625\n",
      "800 loss=1.8152513986551784 accuracy=0.2890625\n",
      "900 loss=1.762328535019229 accuracy=0.3411458333333333\n",
      "1000 loss=1.744429793136149 accuracy=0.3515625\n",
      "1100 loss=1.731026891741837 accuracy=0.34375\n",
      "1200 loss=1.7289842019156665 accuracy=0.3541666666666667\n",
      "1300 loss=1.6878873125760707 accuracy=0.3489583333333333\n",
      "1400 loss=1.6887413008543617 accuracy=0.3697916666666667\n",
      "1500 loss=1.6686743765946028 accuracy=0.3619791666666667\n",
      "1600 loss=1.6477112266839173 accuracy=0.3697916666666667\n",
      "1700 loss=1.632027228039759 accuracy=0.3958333333333333\n",
      "1800 loss=1.6307045446613597 accuracy=0.3932291666666667\n",
      "1900 loss=1.6431852033601753 accuracy=0.4088541666666667\n",
      "2000 loss=1.6063344227787282 accuracy=0.4166666666666667\n",
      "2100 loss=1.6027177028991861 accuracy=0.4010416666666667\n",
      "2200 loss=1.5548151133985937 accuracy=0.4401041666666667\n",
      "2300 loss=1.5377417107528182 accuracy=0.4192708333333333\n",
      "2400 loss=1.5147661368999596 accuracy=0.4140625\n",
      "2500 loss=1.496828196085688 accuracy=0.4505208333333333\n",
      "2600 loss=1.421006706536429 accuracy=0.4713541666666667\n",
      "2700 loss=1.3493780474553208 accuracy=0.4869791666666667\n",
      "2800 loss=1.366076313636892 accuracy=0.4739583333333333\n",
      "2900 loss=1.3154714316878189 accuracy=0.5286458333333334\n",
      "3000 loss=1.2618557238677264 accuracy=0.5260416666666666\n",
      "3100 loss=1.1335967452588247 accuracy=0.6067708333333334\n",
      "3200 loss=1.045013874364372 accuracy=0.6328125\n",
      "3300 loss=0.9978841821664572 accuracy=0.6380208333333334\n",
      "3400 loss=0.9578133132107389 accuracy=0.6510416666666666\n",
      "3500 loss=0.9206870622480143 accuracy=0.6536458333333334\n",
      "3600 loss=0.8230746467868262 accuracy=0.6901041666666666\n",
      "3700 loss=0.7201744099295007 accuracy=0.71875\n",
      "3800 loss=0.6645046275974009 accuracy=0.75\n",
      "3900 loss=0.647547167395673 accuracy=0.7604166666666666\n",
      "4000 loss=0.5646237357290596 accuracy=0.796875\n",
      "4100 loss=0.4203824184149341 accuracy=0.8072916666666666\n",
      "4200 loss=0.3145026368816856 accuracy=0.8645833333333334\n",
      "4300 loss=0.2837300281139824 accuracy=0.8776041666666666\n",
      "4400 loss=0.26881269730035673 accuracy=0.8932291666666666\n",
      "4500 loss=0.23711764612329547 accuracy=0.90625\n",
      "4600 loss=0.20835224397883323 accuracy=0.9192708333333334\n",
      "4700 loss=0.20732490547233456 accuracy=0.9270833333333334\n",
      "4800 loss=0.16911186000959946 accuracy=0.9375\n",
      "4900 loss=0.14574546180884657 accuracy=0.9557291666666666\n",
      "5000 loss=0.143686821179565 accuracy=0.9453125\n",
      "5100 loss=0.12878035944536786 accuracy=0.9557291666666666\n",
      "5200 loss=0.13879376391110082 accuracy=0.9479166666666666\n",
      "5300 loss=0.13507300779185644 accuracy=0.953125\n",
      "5400 loss=0.10573387987413999 accuracy=0.9739583333333334\n",
      "5500 loss=0.13346092553710343 accuracy=0.9479166666666666\n",
      "5600 loss=0.11985412845544581 accuracy=0.9635416666666666\n",
      "5700 loss=0.10496010479639112 accuracy=0.9557291666666666\n",
      "5800 loss=0.11136547465294228 accuracy=0.9505208333333334\n",
      "5900 loss=0.09151486438551404 accuracy=0.9765625\n",
      "6000 loss=0.07329099507571751 accuracy=0.9817708333333334\n",
      "6100 loss=0.10710004370201678 accuracy=0.9583333333333334\n",
      "6200 loss=0.09140887125473891 accuracy=0.9661458333333334\n",
      "6300 loss=0.08878153747311557 accuracy=0.9635416666666666\n",
      "6400 loss=0.10902635173082649 accuracy=0.953125\n",
      "6500 loss=0.0777924798313305 accuracy=0.9713541666666666\n",
      "6600 loss=0.07618718712105657 accuracy=0.9791666666666666\n",
      "6700 loss=0.07222466553852172 accuracy=0.96875\n",
      "6800 loss=0.06582014750626772 accuracy=0.9713541666666666\n",
      "6900 loss=0.057512828374194316 accuracy=0.9869791666666666\n",
      "7000 loss=0.07297245501862654 accuracy=0.9791666666666666\n",
      "7100 loss=0.06719716476347401 accuracy=0.9713541666666666\n",
      "7200 loss=0.055451791936705914 accuracy=0.9791666666666666\n",
      "7300 loss=0.07615967229259969 accuracy=0.96875\n",
      "7400 loss=0.05769497240351383 accuracy=0.9791666666666666\n",
      "7500 loss=0.053460716180503604 accuracy=0.9895833333333334\n",
      "7600 loss=0.06828938971632084 accuracy=0.96875\n",
      "7700 loss=0.04903202016695644 accuracy=0.9817708333333334\n",
      "7800 loss=0.06824995740507735 accuracy=0.96875\n",
      "7900 loss=0.05519248191297258 accuracy=0.9739583333333334\n",
      "8000 loss=0.08721788565444712 accuracy=0.9609375\n",
      "8100 loss=0.06851805630525415 accuracy=0.9661458333333334\n",
      "8200 loss=0.030785869633046543 accuracy=0.9921875\n",
      "8300 loss=0.04522644900002584 accuracy=0.9869791666666666\n",
      "8400 loss=0.04933074828489135 accuracy=0.9817708333333334\n",
      "8500 loss=0.05907327507577062 accuracy=0.9765625\n",
      "8600 loss=0.051783351614472624 accuracy=0.9791666666666666\n",
      "8700 loss=0.051657116696209794 accuracy=0.9765625\n",
      "8800 loss=0.05092409121662751 accuracy=0.9817708333333334\n",
      "8900 loss=0.048302433194931355 accuracy=0.9817708333333334\n",
      "9000 loss=0.06457245395436784 accuracy=0.9713541666666666\n",
      "9100 loss=0.050963917811994164 accuracy=0.9791666666666666\n",
      "9200 loss=0.06011408045644817 accuracy=0.9739583333333334\n",
      "9300 loss=0.046498548250444145 accuracy=0.9791666666666666\n",
      "9400 loss=0.0364394446763089 accuracy=0.9921875\n",
      "9500 loss=0.04546832507410231 accuracy=0.9921875\n",
      "9600 loss=0.05076915164736302 accuracy=0.9791666666666666\n",
      "9700 loss=0.057329476794142784 accuracy=0.9765625\n",
      "9800 loss=0.028690448223893845 accuracy=0.9895833333333334\n",
      "9900 loss=0.03340558475154541 accuracy=0.9947916666666666\n",
      "10000 loss=0.04554441518530773 accuracy=0.984375\n",
      "10100 loss=0.05145132142581538 accuracy=0.9739583333333334\n",
      "10200 loss=0.034476834766979624 accuracy=0.9895833333333334\n",
      "10300 loss=0.03918703263776091 accuracy=0.9869791666666666\n",
      "10400 loss=0.043068462540305344 accuracy=0.9921875\n",
      "10500 loss=0.038876962018615104 accuracy=0.984375\n",
      "10600 loss=0.035995980224783036 accuracy=0.9817708333333334\n",
      "10700 loss=0.03215576991867586 accuracy=0.9869791666666666\n",
      "10800 loss=0.02616014979941534 accuracy=0.9921875\n",
      "10900 loss=0.03355174752836876 accuracy=0.9895833333333334\n",
      "11000 loss=0.04011566275875296 accuracy=0.984375\n",
      "11100 loss=0.046566725192200155 accuracy=0.9791666666666666\n",
      "11200 loss=0.027842833706749573 accuracy=0.9869791666666666\n",
      "11300 loss=0.03803920698162399 accuracy=0.984375\n",
      "11400 loss=0.02732747445452823 accuracy=0.9921875\n",
      "11500 loss=0.043759698746784204 accuracy=0.9791666666666666\n",
      "11600 loss=0.03320205419670742 accuracy=0.9869791666666666\n",
      "11700 loss=0.047871413013982234 accuracy=0.9817708333333334\n",
      "11800 loss=0.039016038301008485 accuracy=0.9791666666666666\n",
      "11900 loss=0.03675646406254713 accuracy=0.9869791666666666\n",
      "12000 loss=0.03691183577460834 accuracy=0.9895833333333334\n",
      "12100 loss=0.03755414990674225 accuracy=0.984375\n",
      "12200 loss=0.02173980379251138 accuracy=0.9921875\n",
      "12300 loss=0.02281437325600453 accuracy=0.9947916666666666\n",
      "12400 loss=0.028202318270261095 accuracy=0.9895833333333334\n",
      "12500 loss=0.03525678290706599 accuracy=0.9869791666666666\n",
      "12600 loss=0.04145909759727897 accuracy=0.984375\n",
      "12700 loss=0.04551284757459814 accuracy=0.9791666666666666\n",
      "12800 loss=0.036110095734187 accuracy=0.9921875\n",
      "12900 loss=0.027572995665923767 accuracy=0.9921875\n",
      "13000 loss=0.019366885823392382 accuracy=0.9947916666666666\n",
      "13100 loss=0.020931135238820148 accuracy=0.9947916666666666\n",
      "13200 loss=0.02465544658601368 accuracy=0.9895833333333334\n",
      "13300 loss=0.018055510258498667 accuracy=0.9921875\n",
      "13400 loss=0.022906601130872107 accuracy=0.9921875\n",
      "13500 loss=0.03150486632535884 accuracy=0.9817708333333334\n",
      "13600 loss=0.02604799932719263 accuracy=0.9921875\n",
      "13700 loss=0.026496083383112795 accuracy=0.9869791666666666\n",
      "13800 loss=0.023344366671450584 accuracy=0.9921875\n",
      "13900 loss=0.030615605053003443 accuracy=0.9869791666666666\n",
      "14000 loss=0.019179041020327428 accuracy=0.9947916666666666\n",
      "14100 loss=0.017185016330778197 accuracy=0.9947916666666666\n",
      "14200 loss=0.018371629407575252 accuracy=0.9895833333333334\n",
      "14300 loss=0.013717325025909118 accuracy=0.9973958333333334\n",
      "14400 loss=0.015109007028711863 accuracy=0.9947916666666666\n",
      "14500 loss=0.014177882137345683 accuracy=0.9973958333333334\n",
      "14600 loss=0.014332774441696361 accuracy=0.9973958333333334\n",
      "14700 loss=0.014442540480203728 accuracy=0.9947916666666666\n",
      "14800 loss=0.03594424233704616 accuracy=0.9921875\n",
      "14900 loss=0.01886981186359554 accuracy=0.9921875\n",
      "15000 loss=0.01823285468641749 accuracy=0.9947916666666666\n",
      "15100 loss=0.020266405738509498 accuracy=0.9947916666666666\n",
      "15200 loss=0.01311823891709449 accuracy=0.9921875\n",
      "15300 loss=0.019208954747532574 accuracy=0.9869791666666666\n",
      "15400 loss=0.013741777951266486 accuracy=0.9947916666666666\n",
      "15500 loss=0.023566236651151058 accuracy=0.9895833333333334\n",
      "15600 loss=0.02519240619862072 accuracy=0.984375\n",
      "15700 loss=0.017141124440198153 accuracy=0.9973958333333334\n",
      "15800 loss=0.027063899265332834 accuracy=0.9895833333333334\n",
      "15900 loss=0.014542789145656609 accuracy=0.9973958333333334\n",
      "16000 loss=0.011629840667838488 accuracy=0.9973958333333334\n",
      "16100 loss=0.018783104810596137 accuracy=0.9921875\n",
      "16200 loss=0.018785005934144727 accuracy=0.9921875\n",
      "16300 loss=0.02127587927298737 accuracy=0.9947916666666666\n",
      "16400 loss=0.0324964450360955 accuracy=0.984375\n",
      "16500 loss=0.01527424798871161 accuracy=0.9947916666666666\n",
      "16600 loss=0.008881865783660042 accuracy=0.9973958333333334\n",
      "16700 loss=0.013573250059131414 accuracy=0.9973958333333334\n",
      "16800 loss=0.02114222424427295 accuracy=0.9947916666666666\n",
      "16900 loss=0.017763166545208722 accuracy=0.9947916666666666\n",
      "17000 loss=0.004251722543173846 accuracy=1.0\n",
      "17100 loss=0.014390941100764562 accuracy=0.9947916666666666\n",
      "17200 loss=0.024691259758610327 accuracy=0.9921875\n",
      "17300 loss=0.002978094425180008 accuracy=1.0\n",
      "17400 loss=0.015406456866861946 accuracy=0.9947916666666666\n",
      "17500 loss=0.024116033979107727 accuracy=0.9921875\n",
      "17600 loss=0.0064582376899794515 accuracy=1.0\n",
      "17700 loss=0.017553571060064145 accuracy=0.9947916666666666\n",
      "17800 loss=0.019113055735865553 accuracy=0.9947916666666666\n",
      "17900 loss=0.0077320575965740095 accuracy=1.0\n",
      "18000 loss=0.011228696497331126 accuracy=0.9947916666666666\n",
      "18100 loss=0.011491397905946806 accuracy=0.9973958333333334\n",
      "18200 loss=0.016791524627903044 accuracy=0.9921875\n",
      "18300 loss=0.01463370508073375 accuracy=0.9947916666666666\n",
      "18400 loss=0.010711671358324536 accuracy=0.9973958333333334\n",
      "18500 loss=0.018864407782732413 accuracy=0.9921875\n",
      "18600 loss=0.03876295106297356 accuracy=0.9869791666666666\n",
      "18700 loss=0.010539595197048314 accuracy=0.9947916666666666\n",
      "18800 loss=0.025660557934376757 accuracy=0.9947916666666666\n",
      "18900 loss=0.007234372377758296 accuracy=0.9973958333333334\n",
      "19000 loss=0.03211169910128645 accuracy=0.9791666666666666\n",
      "19100 loss=0.00969493630354538 accuracy=0.9947916666666666\n",
      "19200 loss=0.013885468303244507 accuracy=0.9947916666666666\n",
      "19300 loss=0.014288512826647927 accuracy=0.9947916666666666\n",
      "19400 loss=0.02027204043733835 accuracy=0.9921875\n",
      "19500 loss=0.01089960812200946 accuracy=0.9973958333333334\n",
      "19600 loss=0.0027146109844854186 accuracy=1.0\n",
      "19700 loss=0.009127018608264603 accuracy=0.9973958333333334\n",
      "19800 loss=0.0050450831116072535 accuracy=0.9973958333333334\n",
      "19900 loss=0.010269271284382743 accuracy=0.9973958333333334\n",
      "epoch=19999 loss=0.009836922248146182 per_token_losses=tensor([0.0103, 0.0112, 0.0238, 0.0099, 0.0025, 0.0013], dtype=torch.float64) accuracy=1.0000 per_token_accuracy=array([1., 1., 1., 1., 1., 1.])\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "b281b43b16e24746bbccbf8ec6838e25",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'hovertemplate': 'variable=0<br>index=%{x}<br>value=%{y}<extra></extra>',\n",
       "              'legendgroup': '0',\n",
       "              'line': {'color': '#636efa', 'dash': 'solid'},\n",
       "              'marker': {'symbol': 'circle'},\n",
       "              'mode': 'lines',\n",
       "              'name': '0',\n",
       "              'showlegend': True,\n",
       "              'type': 'scattergl',\n",
       "              'uid': '4bb6cc63-4ecc-44c3-9a0b-4c65acefe549',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'xaxis': 'x',\n",
       "              'y': array([2.49348918, 2.53679211, 2.48914855, ..., 0.0095832 , 0.00536606,\n",
       "                          0.00983692]),\n",
       "              'yaxis': 'y'}],\n",
       "    'layout': {'legend': {'title': {'text': 'variable'}, 'tracegroupgap': 0},\n",
       "               'template': '...',\n",
       "               'title': {'text': 'train loss'},\n",
       "               'xaxis': {'anchor': 'y', 'domain': [0.0, 1.0], 'title': {'text': ''}},\n",
       "               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': ''}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "2dc2ba2303754de684db171e8b03538e",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': '5cf74357-5c40-41c7-adee-ee89177bbcbe',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.94338885e+00, 2.92703460e+00, 2.86208530e+00, ..., 6.74835422e-04,\n",
       "                          8.51292505e-04, 1.02686566e-02])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': '54d2e887-383e-4eac-9171-6f2bacd31453',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.48306452, 2.49616239, 2.45954217, ..., 0.02861081, 0.01068215,\n",
       "                          0.01115949])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': '65d3edd8-48b8-466a-a9c7-1e3480c12b01',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.39311439, 2.51335756, 2.3748365 , ..., 0.00858495, 0.0087842 ,\n",
       "                          0.02384166])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': '5d02ef94-4fc4-47b0-b43c-15ba133d8be8',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.40815743, 2.47050688, 2.34085858, ..., 0.0165319 , 0.00844083,\n",
       "                          0.0099466 ])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': '39cb71aa-306a-40a4-b89f-20af6a60934c',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.35625198e+00, 2.49087376e+00, 2.44552368e+00, ..., 2.19493575e-03,\n",
       "                          1.99042762e-03, 2.50444686e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': '273348e8-e022-4cb2-b8bc-b52a3dd976a7',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.37695791e+00, 2.32281748e+00, 2.45204504e+00, ..., 9.01770863e-04,\n",
       "                          1.44748782e-03, 1.30067817e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'ce11408c-c1ef-4108-98ab-bc56384d147a',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': [2.4934891781276076, 2.536792112693501, 2.489148545653228, ...,\n",
       "                    0.00958319930221282, 0.005366063578934537,\n",
       "                    0.009836922248146182]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data)'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'Loss'}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "c5f46e9e47ff4ba8a5b3626024868cdb",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'ac9e747f-b947-4fff-9b3c-8c26442c56ca',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.94338885e+00, 2.92703460e+00, 2.86208530e+00, ..., 6.74835422e-04,\n",
       "                          8.51292505e-04, 1.02686566e-02])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': '7bef5e75-db60-45a6-a1f0-fa3f1f16e26a',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.48306452, 2.49616239, 2.45954217, ..., 0.02861081, 0.01068215,\n",
       "                          0.01115949])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': '5b5cdfa2-7338-408c-8e4f-e4a17774b1f3',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.39311439, 2.51335756, 2.3748365 , ..., 0.00858495, 0.0087842 ,\n",
       "                          0.02384166])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'e30e989e-880f-4d4f-a309-4cb6c08de3c0',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.40815743, 2.47050688, 2.34085858, ..., 0.0165319 , 0.00844083,\n",
       "                          0.0099466 ])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'e384d4cf-4dc0-49c3-8686-19e3a91c59f3',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.35625198e+00, 2.49087376e+00, 2.44552368e+00, ..., 2.19493575e-03,\n",
       "                          1.99042762e-03, 2.50444686e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'fb8ab57c-42f5-4d02-bbe3-e18c8d91ff48',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': array([2.37695791e+00, 2.32281748e+00, 2.45204504e+00, ..., 9.01770863e-04,\n",
       "                          1.44748782e-03, 1.30067817e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': '096d6172-2973-401b-9caf-b817e3efa741',\n",
       "              'x': array([    0,     1,     2, ..., 19997, 19998, 19999]),\n",
       "              'y': [2.4934891781276076, 2.536792112693501, 2.489148545653228, ...,\n",
       "                    0.00958319930221282, 0.005366063578934537,\n",
       "                    0.009836922248146182]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data) - Log Y Axis'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'log Loss'}, 'type': 'log'}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "train(is_finite=False, d_model=256, d_mlp=256, num_epochs=20_000, checkpoint_every=1000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "bfc1cec4-16ab-40f4-90e3-fb45dbd0e5a8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "creating new model d_model=64 d_mlp=128 d_head=16 num_layers=1 num_heads=4\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "dce2ac9689cb4b098294a49632e0bc20",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/50000 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 loss=2.441483083948224 accuracy=0.09114583333333333\n",
      "100 loss=2.1346966402111556 accuracy=0.17447916666666666\n",
      "200 loss=2.0281967010744393 accuracy=0.203125\n",
      "300 loss=2.0349934594062224 accuracy=0.22135416666666666\n",
      "400 loss=2.023287540478815 accuracy=0.18489583333333334\n",
      "500 loss=2.019726825310869 accuracy=0.20833333333333334\n",
      "600 loss=1.9969314429486325 accuracy=0.20052083333333334\n",
      "700 loss=2.0029694169250583 accuracy=0.22135416666666666\n",
      "800 loss=1.9711544471860565 accuracy=0.23177083333333334\n",
      "900 loss=1.9629557927856356 accuracy=0.23177083333333334\n",
      "1000 loss=1.9571404527808571 accuracy=0.22135416666666666\n",
      "1100 loss=1.924424083036726 accuracy=0.2552083333333333\n",
      "1200 loss=1.9043771824986813 accuracy=0.3020833333333333\n",
      "1300 loss=1.9008144891381544 accuracy=0.2682291666666667\n",
      "1400 loss=1.917640673880522 accuracy=0.2604166666666667\n",
      "1500 loss=1.8876259359660312 accuracy=0.24479166666666666\n",
      "1600 loss=1.884365894606285 accuracy=0.2682291666666667\n",
      "1700 loss=1.8977812380337167 accuracy=0.24479166666666666\n",
      "1800 loss=1.884306390050714 accuracy=0.2630208333333333\n",
      "1900 loss=1.8726139505921586 accuracy=0.265625\n",
      "2000 loss=1.8444255267788663 accuracy=0.3046875\n",
      "2100 loss=1.8480280041358532 accuracy=0.2864583333333333\n",
      "2200 loss=1.8358306638615733 accuracy=0.2838541666666667\n",
      "2300 loss=1.8221299618391367 accuracy=0.2942708333333333\n",
      "2400 loss=1.812907249928336 accuracy=0.3203125\n",
      "2500 loss=1.8029712292857965 accuracy=0.3046875\n",
      "2600 loss=1.779533913397581 accuracy=0.3177083333333333\n",
      "2700 loss=1.7837263943653188 accuracy=0.328125\n",
      "2800 loss=1.7737651326490393 accuracy=0.3177083333333333\n",
      "2900 loss=1.748732215972257 accuracy=0.3385416666666667\n",
      "3000 loss=1.7518907721047843 accuracy=0.3567708333333333\n",
      "3100 loss=1.7333536241238168 accuracy=0.3463541666666667\n",
      "3200 loss=1.7277533732208767 accuracy=0.3645833333333333\n",
      "3300 loss=1.7109884392802766 accuracy=0.3828125\n",
      "3400 loss=1.7119995423787853 accuracy=0.3541666666666667\n",
      "3500 loss=1.6988778536232438 accuracy=0.3671875\n",
      "3600 loss=1.6973168702340127 accuracy=0.3697916666666667\n",
      "3700 loss=1.6854104771713143 accuracy=0.3880208333333333\n",
      "3800 loss=1.6767056481520823 accuracy=0.3645833333333333\n",
      "3900 loss=1.6777476534690234 accuracy=0.3828125\n",
      "4000 loss=1.6770107663290887 accuracy=0.3854166666666667\n",
      "4100 loss=1.6746805197172843 accuracy=0.3828125\n",
      "4200 loss=1.6555721944749797 accuracy=0.3802083333333333\n",
      "4300 loss=1.6595221130846984 accuracy=0.3932291666666667\n",
      "4400 loss=1.674180117082344 accuracy=0.375\n",
      "4500 loss=1.665962490204715 accuracy=0.375\n",
      "4600 loss=1.6579112096024364 accuracy=0.4010416666666667\n",
      "4700 loss=1.6505573334112609 accuracy=0.3932291666666667\n",
      "4800 loss=1.6510946748261903 accuracy=0.3880208333333333\n",
      "4900 loss=1.6351289209290067 accuracy=0.3958333333333333\n",
      "5000 loss=1.6347979656857934 accuracy=0.421875\n",
      "5100 loss=1.6300115419013026 accuracy=0.3828125\n",
      "5200 loss=1.6315964964067167 accuracy=0.3828125\n",
      "5300 loss=1.6218128227855866 accuracy=0.3932291666666667\n",
      "5400 loss=1.6206337407538645 accuracy=0.3854166666666667\n",
      "5500 loss=1.6262861582713886 accuracy=0.3802083333333333\n",
      "5600 loss=1.6157822356354234 accuracy=0.3828125\n",
      "5700 loss=1.6291353237158168 accuracy=0.3723958333333333\n",
      "5800 loss=1.6201512533463376 accuracy=0.3671875\n",
      "5900 loss=1.6074612469356726 accuracy=0.390625\n",
      "6000 loss=1.6173987144513564 accuracy=0.4140625\n",
      "6100 loss=1.5987416486532926 accuracy=0.4140625\n",
      "6200 loss=1.6041302774834663 accuracy=0.4114583333333333\n",
      "6300 loss=1.597784101888394 accuracy=0.40625\n",
      "6400 loss=1.5922251677536572 accuracy=0.4010416666666667\n",
      "6500 loss=1.597536045382093 accuracy=0.4114583333333333\n",
      "6600 loss=1.599258604291527 accuracy=0.4140625\n",
      "6700 loss=1.6027066024013905 accuracy=0.4088541666666667\n",
      "6800 loss=1.6122638248058838 accuracy=0.3854166666666667\n",
      "6900 loss=1.5897727534863404 accuracy=0.3958333333333333\n",
      "7000 loss=1.609813634605171 accuracy=0.390625\n",
      "7100 loss=1.5953041685714802 accuracy=0.375\n",
      "7200 loss=1.6004647484979846 accuracy=0.3984375\n",
      "7300 loss=1.5815270650608935 accuracy=0.4010416666666667\n",
      "7400 loss=1.6031544801556281 accuracy=0.3645833333333333\n",
      "7500 loss=1.5871856387808734 accuracy=0.4088541666666667\n",
      "7600 loss=1.579718905943981 accuracy=0.3932291666666667\n",
      "7700 loss=1.5607686263884908 accuracy=0.390625\n",
      "7800 loss=1.5448983549174793 accuracy=0.40625\n",
      "7900 loss=1.5501151984760106 accuracy=0.4010416666666667\n",
      "8000 loss=1.5300123287984047 accuracy=0.4427083333333333\n",
      "8100 loss=1.4980275860423027 accuracy=0.4427083333333333\n",
      "8200 loss=1.4873235990803544 accuracy=0.4375\n",
      "8300 loss=1.4827352664494928 accuracy=0.4635416666666667\n",
      "8400 loss=1.4519064789646348 accuracy=0.453125\n",
      "8500 loss=1.467722313946123 accuracy=0.4947916666666667\n",
      "8600 loss=1.4299915634738283 accuracy=0.4921875\n",
      "8700 loss=1.3954538598455877 accuracy=0.5\n",
      "8800 loss=1.3944243174822315 accuracy=0.5104166666666666\n",
      "8900 loss=1.3990899485751485 accuracy=0.5078125\n",
      "9000 loss=1.3787141270267935 accuracy=0.5338541666666666\n",
      "9100 loss=1.393072092170642 accuracy=0.5130208333333334\n",
      "9200 loss=1.367629055046334 accuracy=0.546875\n",
      "9300 loss=1.3394186856841555 accuracy=0.5182291666666666\n",
      "9400 loss=1.3309332743755373 accuracy=0.5338541666666666\n",
      "9500 loss=1.3375796936286193 accuracy=0.5052083333333334\n",
      "9600 loss=1.3566819571113418 accuracy=0.5182291666666666\n",
      "9700 loss=1.3602377066775575 accuracy=0.5364583333333334\n",
      "9800 loss=1.3247274520866856 accuracy=0.5260416666666666\n",
      "9900 loss=1.3034750965686346 accuracy=0.5234375\n",
      "10000 loss=1.2986685504138145 accuracy=0.5260416666666666\n",
      "10100 loss=1.3175363183453146 accuracy=0.53125\n",
      "10200 loss=1.3025394443762115 accuracy=0.5520833333333334\n",
      "10300 loss=1.2931262365064082 accuracy=0.5338541666666666\n",
      "10400 loss=1.2646116475500997 accuracy=0.5807291666666666\n",
      "10500 loss=1.2909087812694917 accuracy=0.5208333333333334\n",
      "10600 loss=1.272040602112651 accuracy=0.5442708333333334\n",
      "10700 loss=1.2474995962340512 accuracy=0.53125\n",
      "10800 loss=1.2556487447495264 accuracy=0.5598958333333334\n",
      "10900 loss=1.2625499549811159 accuracy=0.546875\n",
      "11000 loss=1.24290588308109 accuracy=0.5651041666666666\n",
      "11100 loss=1.2502509409176725 accuracy=0.546875\n",
      "11200 loss=1.2400230417292564 accuracy=0.5234375\n",
      "11300 loss=1.2597373471881907 accuracy=0.5364583333333334\n",
      "11400 loss=1.2535395676651007 accuracy=0.5416666666666666\n",
      "11500 loss=1.2309461783038957 accuracy=0.546875\n",
      "11600 loss=1.2681381199812765 accuracy=0.546875\n",
      "11700 loss=1.2456236894615056 accuracy=0.5416666666666666\n",
      "11800 loss=1.222270142358241 accuracy=0.5703125\n",
      "11900 loss=1.2466937897555912 accuracy=0.5390625\n",
      "12000 loss=1.229698789966967 accuracy=0.5390625\n",
      "12100 loss=1.2139599900619062 accuracy=0.5520833333333334\n",
      "12200 loss=1.2108916686011812 accuracy=0.5286458333333334\n",
      "12300 loss=1.2309307794455397 accuracy=0.5651041666666666\n",
      "12400 loss=1.2273747583741006 accuracy=0.5494791666666666\n",
      "12500 loss=1.2105527105647744 accuracy=0.5625\n",
      "12600 loss=1.191328176604138 accuracy=0.5546875\n",
      "12700 loss=1.2094482423143673 accuracy=0.5338541666666666\n",
      "12800 loss=1.2094234225177527 accuracy=0.5572916666666666\n",
      "12900 loss=1.2056653842932807 accuracy=0.5494791666666666\n",
      "13000 loss=1.2120954211497281 accuracy=0.5651041666666666\n",
      "13100 loss=1.199592090385783 accuracy=0.5494791666666666\n",
      "13200 loss=1.202515008382342 accuracy=0.5598958333333334\n",
      "13300 loss=1.1989977749481593 accuracy=0.5494791666666666\n",
      "13400 loss=1.20468335225633 accuracy=0.5598958333333334\n",
      "13500 loss=1.194793961937559 accuracy=0.5703125\n",
      "13600 loss=1.2072035155988927 accuracy=0.5442708333333334\n",
      "13700 loss=1.2104279589073115 accuracy=0.5416666666666666\n",
      "13800 loss=1.1941402810784845 accuracy=0.5546875\n",
      "13900 loss=1.2018825074911272 accuracy=0.5520833333333334\n",
      "14000 loss=1.1938754471951933 accuracy=0.5442708333333334\n",
      "14100 loss=1.2013818018721572 accuracy=0.5442708333333334\n",
      "14200 loss=1.187529974933712 accuracy=0.5572916666666666\n",
      "14300 loss=1.1823265674490457 accuracy=0.5598958333333334\n",
      "14400 loss=1.1836607918682516 accuracy=0.5729166666666666\n",
      "14500 loss=1.1928970235170264 accuracy=0.5442708333333334\n",
      "14600 loss=1.1931599241898578 accuracy=0.5390625\n",
      "14700 loss=1.2010271025153907 accuracy=0.5364583333333334\n",
      "14800 loss=1.1880343738871928 accuracy=0.5677083333333334\n",
      "14900 loss=1.2053201473535462 accuracy=0.53125\n",
      "15000 loss=1.1898562820216885 accuracy=0.5625\n",
      "15100 loss=1.1937444111713775 accuracy=0.5416666666666666\n",
      "15200 loss=1.1881235470816216 accuracy=0.5442708333333334\n",
      "15300 loss=1.2011039104129695 accuracy=0.5260416666666666\n",
      "15400 loss=1.178985222757305 accuracy=0.5546875\n",
      "15500 loss=1.2018010685149525 accuracy=0.5338541666666666\n",
      "15600 loss=1.1828312236938996 accuracy=0.5442708333333334\n",
      "15700 loss=1.1910561532777901 accuracy=0.5572916666666666\n",
      "15800 loss=1.1797177464248816 accuracy=0.5416666666666666\n",
      "15900 loss=1.1823209742405911 accuracy=0.5703125\n",
      "16000 loss=1.1767899756047786 accuracy=0.5338541666666666\n",
      "16100 loss=1.1798223063276798 accuracy=0.5625\n",
      "16200 loss=1.181605369833305 accuracy=0.546875\n",
      "16300 loss=1.171733247976165 accuracy=0.5651041666666666\n",
      "16400 loss=1.187526484192299 accuracy=0.5520833333333334\n",
      "16500 loss=1.207059036226368 accuracy=0.5364583333333334\n",
      "16600 loss=1.1765043799842525 accuracy=0.5442708333333334\n",
      "16700 loss=1.1730275523252112 accuracy=0.5442708333333334\n",
      "16800 loss=1.1777993686333499 accuracy=0.5546875\n",
      "16900 loss=1.1909606080984034 accuracy=0.5442708333333334\n",
      "17000 loss=1.195375759160646 accuracy=0.5390625\n",
      "17100 loss=1.1790557212418706 accuracy=0.5442708333333334\n",
      "17200 loss=1.1968562923880055 accuracy=0.5520833333333334\n",
      "17300 loss=1.185693421960691 accuracy=0.5494791666666666\n",
      "17400 loss=1.1811183379110226 accuracy=0.5677083333333334\n",
      "17500 loss=1.1831534574375775 accuracy=0.5494791666666666\n",
      "17600 loss=1.187807819876681 accuracy=0.5338541666666666\n",
      "17700 loss=1.1746677628532576 accuracy=0.5520833333333334\n",
      "17800 loss=1.1788448837267334 accuracy=0.5572916666666666\n",
      "17900 loss=1.1734478139890503 accuracy=0.5364583333333334\n",
      "18000 loss=1.1851947619812937 accuracy=0.5598958333333334\n",
      "18100 loss=1.1874626254749416 accuracy=0.5390625\n",
      "18200 loss=1.1684162576178405 accuracy=0.5494791666666666\n",
      "18300 loss=1.1813970409612842 accuracy=0.5494791666666666\n",
      "18400 loss=1.187931245327996 accuracy=0.5416666666666666\n",
      "18500 loss=1.1664647881306804 accuracy=0.5755208333333334\n",
      "18600 loss=1.1821507767396169 accuracy=0.5364583333333334\n",
      "18700 loss=1.1823586555173284 accuracy=0.5625\n",
      "18800 loss=1.1774255158446272 accuracy=0.5390625\n",
      "18900 loss=1.1788066521038731 accuracy=0.5546875\n",
      "19000 loss=1.1670218605239286 accuracy=0.5729166666666666\n",
      "19100 loss=1.1731641050642372 accuracy=0.5625\n",
      "19200 loss=1.1752176546643187 accuracy=0.5520833333333334\n",
      "19300 loss=1.175068111246262 accuracy=0.53125\n",
      "19400 loss=1.174655028864841 accuracy=0.5572916666666666\n",
      "19500 loss=1.1734529795092805 accuracy=0.5520833333333334\n",
      "19600 loss=1.1855288263874428 accuracy=0.5572916666666666\n",
      "19700 loss=1.1667363105944655 accuracy=0.546875\n",
      "19800 loss=1.1721874569515314 accuracy=0.5677083333333334\n",
      "19900 loss=1.1776652394041014 accuracy=0.5546875\n",
      "20000 loss=1.1662282546500606 accuracy=0.5572916666666666\n",
      "20100 loss=1.1637824260267482 accuracy=0.5598958333333334\n",
      "20200 loss=1.1849114626242019 accuracy=0.5520833333333334\n",
      "20300 loss=1.1719133032973312 accuracy=0.5494791666666666\n",
      "20400 loss=1.1762524897190243 accuracy=0.5520833333333334\n",
      "20500 loss=1.1662111751354065 accuracy=0.5520833333333334\n",
      "20600 loss=1.1734642205355243 accuracy=0.546875\n",
      "20700 loss=1.167673528687069 accuracy=0.5520833333333334\n",
      "20800 loss=1.1829123466380138 accuracy=0.5572916666666666\n",
      "20900 loss=1.1874408477430647 accuracy=0.5520833333333334\n",
      "21000 loss=1.179829030034572 accuracy=0.546875\n",
      "21100 loss=1.1756368799206292 accuracy=0.5598958333333334\n",
      "21200 loss=1.1763679886236484 accuracy=0.5416666666666666\n",
      "21300 loss=1.1658574913154658 accuracy=0.5546875\n",
      "21400 loss=1.199001190863137 accuracy=0.5390625\n",
      "21500 loss=1.1737110361624734 accuracy=0.546875\n",
      "21600 loss=1.1625170394255513 accuracy=0.546875\n",
      "21700 loss=1.1674625769686433 accuracy=0.5677083333333334\n",
      "21800 loss=1.1706113555076096 accuracy=0.5494791666666666\n",
      "21900 loss=1.1760167014682654 accuracy=0.5494791666666666\n",
      "22000 loss=1.1686256776956656 accuracy=0.5911458333333334\n",
      "22100 loss=1.1637567459452707 accuracy=0.5703125\n",
      "22200 loss=1.1620840244960349 accuracy=0.5546875\n",
      "22300 loss=1.1641873152293156 accuracy=0.5677083333333334\n",
      "22400 loss=1.1626433925690685 accuracy=0.578125\n",
      "22500 loss=1.1652003277160585 accuracy=0.5442708333333334\n",
      "22600 loss=1.16458430589168 accuracy=0.5598958333333334\n",
      "22700 loss=1.1628244774958216 accuracy=0.5494791666666666\n",
      "22800 loss=1.180312673107925 accuracy=0.5442708333333334\n",
      "22900 loss=1.16023430757062 accuracy=0.546875\n",
      "23000 loss=1.1627490286985989 accuracy=0.546875\n",
      "23100 loss=1.1545142159679636 accuracy=0.5598958333333334\n",
      "23200 loss=1.1735555692593258 accuracy=0.546875\n",
      "23300 loss=1.2007740786094239 accuracy=0.5625\n",
      "23400 loss=1.1529164945953423 accuracy=0.5729166666666666\n",
      "23500 loss=1.1521120154238949 accuracy=0.5546875\n",
      "23600 loss=1.1469918577694784 accuracy=0.5703125\n",
      "23700 loss=1.1576669884827067 accuracy=0.5625\n",
      "23800 loss=1.169509519778095 accuracy=0.5390625\n",
      "23900 loss=1.151594292206122 accuracy=0.5494791666666666\n",
      "24000 loss=1.1545015041504887 accuracy=0.5807291666666666\n",
      "24100 loss=1.1705771354363492 accuracy=0.5651041666666666\n",
      "24200 loss=1.1693814889510756 accuracy=0.546875\n",
      "24300 loss=1.1556769265531976 accuracy=0.5520833333333334\n",
      "24400 loss=1.1499383001098746 accuracy=0.578125\n",
      "24500 loss=1.158441672912638 accuracy=0.5572916666666666\n",
      "24600 loss=1.1765687235463504 accuracy=0.5572916666666666\n",
      "24700 loss=1.1652509603348729 accuracy=0.5625\n",
      "24800 loss=1.1730391480420606 accuracy=0.5520833333333334\n",
      "24900 loss=1.1747987432734424 accuracy=0.5416666666666666\n",
      "25000 loss=1.1224151862993086 accuracy=0.5729166666666666\n",
      "25100 loss=1.1353093655968998 accuracy=0.5729166666666666\n",
      "25200 loss=1.156454880254926 accuracy=0.5677083333333334\n",
      "25300 loss=1.133580191852799 accuracy=0.578125\n",
      "25400 loss=1.1268889886041653 accuracy=0.5755208333333334\n",
      "25500 loss=1.1193055130946656 accuracy=0.5833333333333334\n",
      "25600 loss=1.103576931243625 accuracy=0.5598958333333334\n",
      "25700 loss=1.064660044104191 accuracy=0.578125\n",
      "25800 loss=1.0663618044401493 accuracy=0.5807291666666666\n",
      "25900 loss=1.0364249893635353 accuracy=0.6276041666666666\n",
      "26000 loss=0.9648115621900106 accuracy=0.6770833333333334\n",
      "26100 loss=0.9693580272256581 accuracy=0.6145833333333334\n",
      "26200 loss=0.9188888950551022 accuracy=0.6458333333333334\n",
      "26300 loss=0.8717349023531199 accuracy=0.6875\n",
      "26400 loss=0.8271116958526623 accuracy=0.6927083333333334\n",
      "26500 loss=0.8549600761942593 accuracy=0.6875\n",
      "26600 loss=0.8250634925047233 accuracy=0.6953125\n",
      "26700 loss=0.8060186559365108 accuracy=0.7057291666666666\n",
      "26800 loss=0.8115557826554798 accuracy=0.703125\n",
      "26900 loss=0.8294843319832719 accuracy=0.7005208333333334\n",
      "27000 loss=0.7257486895021459 accuracy=0.7395833333333334\n",
      "27100 loss=0.7740433317897055 accuracy=0.7291666666666666\n",
      "27200 loss=0.6950785139390101 accuracy=0.7317708333333334\n",
      "27300 loss=0.6449992668588114 accuracy=0.7708333333333334\n",
      "27400 loss=0.6212641237329797 accuracy=0.7708333333333334\n",
      "27500 loss=0.6085521579699467 accuracy=0.7890625\n",
      "27600 loss=0.5518659140829015 accuracy=0.8203125\n",
      "27700 loss=0.556847056237219 accuracy=0.8098958333333334\n",
      "27800 loss=0.5265804805750206 accuracy=0.8307291666666666\n",
      "27900 loss=0.5113009322006691 accuracy=0.8072916666666666\n",
      "28000 loss=0.5136510297039657 accuracy=0.8203125\n",
      "28100 loss=0.5176869953125318 accuracy=0.7994791666666666\n",
      "28200 loss=0.4880418697568669 accuracy=0.8307291666666666\n",
      "28300 loss=0.4830235552158649 accuracy=0.8411458333333334\n",
      "28400 loss=0.495975538806675 accuracy=0.8151041666666666\n",
      "28500 loss=0.4988413461091755 accuracy=0.8151041666666666\n",
      "28600 loss=0.5041915941417516 accuracy=0.8177083333333334\n",
      "28700 loss=0.49059525844358 accuracy=0.8151041666666666\n",
      "28800 loss=0.4638254394505835 accuracy=0.8307291666666666\n",
      "28900 loss=0.469377069047725 accuracy=0.8333333333333334\n",
      "29000 loss=0.4547717791187661 accuracy=0.8463541666666666\n",
      "29100 loss=0.48030929671727307 accuracy=0.8098958333333334\n",
      "29200 loss=0.4549636969358205 accuracy=0.828125\n",
      "29300 loss=0.45892106441542446 accuracy=0.8385416666666666\n",
      "29400 loss=0.4475483695575748 accuracy=0.8307291666666666\n",
      "29500 loss=0.46961706036419143 accuracy=0.8203125\n",
      "29600 loss=0.45379428379091596 accuracy=0.8151041666666666\n",
      "29700 loss=0.4530941496503567 accuracy=0.8411458333333334\n",
      "29800 loss=0.44521584179914664 accuracy=0.8333333333333334\n",
      "29900 loss=0.4559456995157443 accuracy=0.8333333333333334\n",
      "30000 loss=0.45467285800611346 accuracy=0.8307291666666666\n",
      "30100 loss=0.44466413535092 accuracy=0.8385416666666666\n",
      "30200 loss=0.4549442084641857 accuracy=0.8385416666666666\n",
      "30300 loss=0.43843570738845444 accuracy=0.8411458333333334\n",
      "30400 loss=0.4219706369470293 accuracy=0.8567708333333334\n",
      "30500 loss=0.43654666741364184 accuracy=0.8307291666666666\n",
      "30600 loss=0.45721969133537843 accuracy=0.8255208333333334\n",
      "30700 loss=0.4261077068525348 accuracy=0.859375\n",
      "30800 loss=0.4265710357288388 accuracy=0.8359375\n",
      "30900 loss=0.40246534511314613 accuracy=0.8489583333333334\n",
      "31000 loss=0.4117467795410511 accuracy=0.84375\n",
      "31100 loss=0.4234372886613468 accuracy=0.84375\n",
      "31200 loss=0.3717003792487637 accuracy=0.8645833333333334\n",
      "31300 loss=0.36817264523151083 accuracy=0.8645833333333334\n",
      "31400 loss=0.32671214721417813 accuracy=0.8567708333333334\n",
      "31500 loss=0.27729208297410307 accuracy=0.8880208333333334\n",
      "31600 loss=0.2681410633522491 accuracy=0.8880208333333334\n",
      "31700 loss=0.21503160228007434 accuracy=0.9192708333333334\n",
      "31800 loss=0.17589601372187774 accuracy=0.9427083333333334\n",
      "31900 loss=0.16055926783044527 accuracy=0.9192708333333334\n",
      "32000 loss=0.14136248854869893 accuracy=0.9661458333333334\n",
      "32100 loss=0.1436625191849648 accuracy=0.9401041666666666\n",
      "32200 loss=0.14626556854740105 accuracy=0.9453125\n",
      "32300 loss=0.14427486414344404 accuracy=0.9427083333333334\n",
      "32400 loss=0.12016208756412569 accuracy=0.9635416666666666\n",
      "32500 loss=0.13358896349641275 accuracy=0.9557291666666666\n",
      "32600 loss=0.1204280098384784 accuracy=0.96875\n",
      "32700 loss=0.13497382179432066 accuracy=0.9505208333333334\n",
      "32800 loss=0.09033118431321716 accuracy=0.9765625\n",
      "32900 loss=0.1090967194351672 accuracy=0.9635416666666666\n",
      "33000 loss=0.08478656689777722 accuracy=0.9817708333333334\n",
      "33100 loss=0.12427047794386986 accuracy=0.9505208333333334\n",
      "33200 loss=0.09796418812388503 accuracy=0.9635416666666666\n",
      "33300 loss=0.10647467768422149 accuracy=0.9739583333333334\n",
      "33400 loss=0.09824474954967129 accuracy=0.9661458333333334\n",
      "33500 loss=0.10680145620491677 accuracy=0.9557291666666666\n",
      "33600 loss=0.09882264647657815 accuracy=0.9713541666666666\n",
      "33700 loss=0.09855382739861741 accuracy=0.9739583333333334\n",
      "33800 loss=0.10656761933984993 accuracy=0.9557291666666666\n",
      "33900 loss=0.09926527431877433 accuracy=0.9765625\n",
      "34000 loss=0.09039825160138888 accuracy=0.9609375\n",
      "34100 loss=0.08248680266255018 accuracy=0.9661458333333334\n",
      "34200 loss=0.09019194104336764 accuracy=0.9661458333333334\n",
      "34300 loss=0.08659048957450945 accuracy=0.9739583333333334\n",
      "34400 loss=0.09203790385550606 accuracy=0.9791666666666666\n",
      "34500 loss=0.08670410194053868 accuracy=0.9583333333333334\n",
      "34600 loss=0.08754103056197074 accuracy=0.9713541666666666\n",
      "34700 loss=0.09062267445096729 accuracy=0.9765625\n",
      "34800 loss=0.09030278470040544 accuracy=0.9713541666666666\n",
      "34900 loss=0.09666945362912924 accuracy=0.9765625\n",
      "35000 loss=0.08561393940666936 accuracy=0.96875\n",
      "35100 loss=0.0950648285843673 accuracy=0.9635416666666666\n",
      "35200 loss=0.07960149207052275 accuracy=0.9765625\n",
      "35300 loss=0.08497689777076396 accuracy=0.9791666666666666\n",
      "35400 loss=0.07851677128236456 accuracy=0.9817708333333334\n",
      "35500 loss=0.06318176182179211 accuracy=0.9869791666666666\n",
      "35600 loss=0.08017504526077321 accuracy=0.9713541666666666\n",
      "35700 loss=0.08321261297261408 accuracy=0.96875\n",
      "35800 loss=0.09528589336643158 accuracy=0.9739583333333334\n",
      "35900 loss=0.08668755634351816 accuracy=0.9661458333333334\n",
      "36000 loss=0.07893007200769214 accuracy=0.9791666666666666\n",
      "36100 loss=0.09298550242873904 accuracy=0.9609375\n",
      "36200 loss=0.0797397388271804 accuracy=0.9765625\n",
      "36300 loss=0.0839549838278193 accuracy=0.9713541666666666\n",
      "36400 loss=0.07463056357735859 accuracy=0.9765625\n",
      "36500 loss=0.07336543792553742 accuracy=0.9713541666666666\n",
      "36600 loss=0.06374054350380705 accuracy=0.9817708333333334\n",
      "36700 loss=0.07254413100012869 accuracy=0.9765625\n",
      "36800 loss=0.06224722329965768 accuracy=0.9817708333333334\n",
      "36900 loss=0.07572328196664099 accuracy=0.9791666666666666\n",
      "37000 loss=0.06792126976412027 accuracy=0.984375\n",
      "37100 loss=0.065566802723236 accuracy=0.9817708333333334\n",
      "37200 loss=0.07387577481260829 accuracy=0.9817708333333334\n",
      "37300 loss=0.07623902223732304 accuracy=0.9713541666666666\n",
      "37400 loss=0.07531828609986892 accuracy=0.9817708333333334\n",
      "37500 loss=0.06351875528580343 accuracy=0.9791666666666666\n",
      "37600 loss=0.08574032654031818 accuracy=0.9713541666666666\n",
      "37700 loss=0.05995787513947265 accuracy=0.9869791666666666\n",
      "37800 loss=0.07514619122912322 accuracy=0.96875\n",
      "37900 loss=0.07755331939889251 accuracy=0.9765625\n",
      "38000 loss=0.05655845506024973 accuracy=0.9895833333333334\n",
      "38100 loss=0.0794521038115077 accuracy=0.9635416666666666\n",
      "38200 loss=0.06609726180109374 accuracy=0.9869791666666666\n",
      "38300 loss=0.06832016275800668 accuracy=0.9869791666666666\n",
      "38400 loss=0.07299644390257318 accuracy=0.984375\n",
      "38500 loss=0.06611273972050855 accuracy=0.9817708333333334\n",
      "38600 loss=0.076551437789186 accuracy=0.9713541666666666\n",
      "38700 loss=0.07057587678423446 accuracy=0.9869791666666666\n",
      "38800 loss=0.08548576106179331 accuracy=0.9713541666666666\n",
      "38900 loss=0.05715974415631572 accuracy=0.9921875\n",
      "39000 loss=0.07638337610325008 accuracy=0.9869791666666666\n",
      "39100 loss=0.07705988209329151 accuracy=0.9713541666666666\n",
      "39200 loss=0.06790138381464594 accuracy=0.984375\n",
      "39300 loss=0.0783706009246883 accuracy=0.9739583333333334\n",
      "39400 loss=0.06260909435237558 accuracy=0.984375\n",
      "39500 loss=0.059369503279600395 accuracy=0.9895833333333334\n",
      "39600 loss=0.06599201756685256 accuracy=0.9869791666666666\n",
      "39700 loss=0.08143098957064877 accuracy=0.96875\n",
      "39800 loss=0.0605754080497181 accuracy=0.9895833333333334\n",
      "39900 loss=0.09089948711745921 accuracy=0.96875\n",
      "40000 loss=0.07211858124660223 accuracy=0.984375\n",
      "40100 loss=0.07178883295313457 accuracy=0.9817708333333334\n",
      "40200 loss=0.06951327299051725 accuracy=0.96875\n",
      "40300 loss=0.07446652897982695 accuracy=0.9739583333333334\n",
      "40400 loss=0.06383388827430975 accuracy=0.9791666666666666\n",
      "40500 loss=0.05925691941372938 accuracy=0.9817708333333334\n",
      "40600 loss=0.06098468024437718 accuracy=0.9895833333333334\n",
      "40700 loss=0.06493014451552157 accuracy=0.984375\n",
      "40800 loss=0.06102782118187553 accuracy=0.9817708333333334\n",
      "40900 loss=0.0633099920981508 accuracy=0.984375\n",
      "41000 loss=0.06734994630683579 accuracy=0.9791666666666666\n",
      "41100 loss=0.08082969111352552 accuracy=0.9661458333333334\n",
      "41200 loss=0.08562060249042942 accuracy=0.9661458333333334\n",
      "41300 loss=0.06950007488240685 accuracy=0.9739583333333334\n",
      "41400 loss=0.052308594140721934 accuracy=0.984375\n",
      "41500 loss=0.06728794500576088 accuracy=0.984375\n",
      "41600 loss=0.06999999651160063 accuracy=0.96875\n",
      "41700 loss=0.060331071207978884 accuracy=0.9921875\n",
      "41800 loss=0.0822566939860162 accuracy=0.9661458333333334\n",
      "41900 loss=0.07340691150991781 accuracy=0.9765625\n",
      "42000 loss=0.08214660156053014 accuracy=0.9713541666666666\n",
      "42100 loss=0.0702371857715641 accuracy=0.9817708333333334\n",
      "42200 loss=0.0591840542204222 accuracy=0.9791666666666666\n",
      "42300 loss=0.05611564681654478 accuracy=0.9765625\n",
      "42400 loss=0.08528329946051125 accuracy=0.9635416666666666\n",
      "42500 loss=0.05598927823881568 accuracy=0.9869791666666666\n",
      "42600 loss=0.057934959443464475 accuracy=0.9739583333333334\n",
      "42700 loss=0.06345180007127112 accuracy=0.984375\n",
      "42800 loss=0.05811900475044318 accuracy=0.9895833333333334\n",
      "42900 loss=0.06522254135993358 accuracy=0.9921875\n",
      "43000 loss=0.07775567695354196 accuracy=0.9765625\n",
      "43100 loss=0.07409199433222033 accuracy=0.9739583333333334\n",
      "43200 loss=0.06995587478754169 accuracy=0.9817708333333334\n",
      "43300 loss=0.060744889357933825 accuracy=0.9869791666666666\n",
      "43400 loss=0.050345741647172815 accuracy=0.9947916666666666\n",
      "43500 loss=0.0521074315282411 accuracy=0.9921875\n",
      "43600 loss=0.04683939176063484 accuracy=0.9973958333333334\n",
      "43700 loss=0.05892531456974385 accuracy=0.9739583333333334\n",
      "43800 loss=0.05920105910397808 accuracy=0.9817708333333334\n",
      "43900 loss=0.05237315677085737 accuracy=0.984375\n",
      "44000 loss=0.06691088954704907 accuracy=0.9791666666666666\n",
      "44100 loss=0.059238869684530196 accuracy=0.984375\n",
      "44200 loss=0.044924975848758014 accuracy=0.9921875\n",
      "44300 loss=0.05696257004239365 accuracy=0.984375\n",
      "44400 loss=0.05988905293629933 accuracy=0.9921875\n",
      "44500 loss=0.07918096211695305 accuracy=0.9713541666666666\n",
      "44600 loss=0.05738009413623321 accuracy=0.9895833333333334\n",
      "44700 loss=0.06267090599624209 accuracy=0.9791666666666666\n",
      "44800 loss=0.0803880622494727 accuracy=0.9635416666666666\n",
      "44900 loss=0.06231342401504025 accuracy=0.9817708333333334\n",
      "45000 loss=0.0558795530711555 accuracy=0.9921875\n",
      "45100 loss=0.05777223714200822 accuracy=0.9817708333333334\n",
      "45200 loss=0.05503042727516727 accuracy=0.9791666666666666\n",
      "45300 loss=0.04461266252165588 accuracy=0.9973958333333334\n",
      "45400 loss=0.040305025827284166 accuracy=0.9947916666666666\n",
      "45500 loss=0.06677383172338659 accuracy=0.9817708333333334\n",
      "45600 loss=0.062138072405137704 accuracy=0.9895833333333334\n",
      "45700 loss=0.06499691402422123 accuracy=0.9765625\n",
      "45800 loss=0.060006977877221014 accuracy=0.9791666666666666\n",
      "45900 loss=0.05048605710911408 accuracy=0.984375\n",
      "46000 loss=0.04923803299814693 accuracy=0.9869791666666666\n",
      "46100 loss=0.0663466464686902 accuracy=0.9817708333333334\n",
      "46200 loss=0.058336468160225724 accuracy=0.984375\n",
      "46300 loss=0.04972806203136535 accuracy=0.984375\n",
      "46400 loss=0.07003385280186898 accuracy=0.9739583333333334\n",
      "46500 loss=0.048949236354579984 accuracy=0.9921875\n",
      "46600 loss=0.08128725894741073 accuracy=0.9765625\n",
      "46700 loss=0.055060356708804305 accuracy=0.9791666666666666\n",
      "46800 loss=0.07011688352996222 accuracy=0.984375\n",
      "46900 loss=0.06449592559486793 accuracy=0.9739583333333334\n",
      "47000 loss=0.05458097641495544 accuracy=0.9817708333333334\n",
      "47100 loss=0.06466084875940606 accuracy=0.9765625\n",
      "47200 loss=0.045463526846707104 accuracy=0.9895833333333334\n",
      "47300 loss=0.05654990994833412 accuracy=0.9921875\n",
      "47400 loss=0.060516063436719364 accuracy=0.9817708333333334\n",
      "47500 loss=0.05270234460678559 accuracy=0.9921875\n",
      "47600 loss=0.044733302134256 accuracy=0.9947916666666666\n",
      "47700 loss=0.053008156534734854 accuracy=0.9947916666666666\n",
      "47800 loss=0.06150645248299305 accuracy=0.9817708333333334\n",
      "47900 loss=0.06248891109850172 accuracy=0.9791666666666666\n",
      "48000 loss=0.06600222319068057 accuracy=0.9765625\n",
      "48100 loss=0.045046994423711996 accuracy=0.9921875\n",
      "48200 loss=0.04162493515250208 accuracy=0.9973958333333334\n",
      "48300 loss=0.04241372631638819 accuracy=0.9895833333333334\n",
      "48400 loss=0.035767328782014204 accuracy=0.9973958333333334\n",
      "48500 loss=0.05420068549515692 accuracy=0.9869791666666666\n",
      "48600 loss=0.03963769215087987 accuracy=0.9921875\n",
      "48700 loss=0.059537424290665476 accuracy=0.9791666666666666\n",
      "48800 loss=0.05322035267568695 accuracy=0.9895833333333334\n",
      "48900 loss=0.071442028055799 accuracy=0.9765625\n",
      "49000 loss=0.05083987046618125 accuracy=0.9947916666666666\n",
      "49100 loss=0.06454232773548021 accuracy=0.9713541666666666\n",
      "49200 loss=0.04228316038768336 accuracy=0.9947916666666666\n",
      "49300 loss=0.05313771694200179 accuracy=0.9895833333333334\n",
      "49400 loss=0.0559861269590944 accuracy=0.9817708333333334\n",
      "49500 loss=0.047821941326419634 accuracy=0.9869791666666666\n",
      "49600 loss=0.04157638491359104 accuracy=0.9947916666666666\n",
      "49700 loss=0.04371819014695492 accuracy=0.9921875\n",
      "49800 loss=0.05061326224129826 accuracy=0.9921875\n",
      "49900 loss=0.06816005786614533 accuracy=0.9791666666666666\n",
      "epoch=49999 loss=0.06164273354724749 per_token_losses=tensor([0.0010, 0.0933, 0.1416, 0.1097, 0.0236, 0.0007], dtype=torch.float64) accuracy=0.9766 per_token_accuracy=array([1.      , 0.96875 , 0.9375  , 0.953125, 1.      , 1.      ])\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "612c095b0446450cb295ae5e9813315d",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'hovertemplate': 'variable=0<br>index=%{x}<br>value=%{y}<extra></extra>',\n",
       "              'legendgroup': '0',\n",
       "              'line': {'color': '#636efa', 'dash': 'solid'},\n",
       "              'marker': {'symbol': 'circle'},\n",
       "              'mode': 'lines',\n",
       "              'name': '0',\n",
       "              'showlegend': True,\n",
       "              'type': 'scattergl',\n",
       "              'uid': 'a138d65f-b8f1-4d7a-a239-27160717b7ec',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'xaxis': 'x',\n",
       "              'y': array([2.44148308, 2.44950417, 2.49582989, ..., 0.04512879, 0.0466183 ,\n",
       "                          0.06164273]),\n",
       "              'yaxis': 'y'}],\n",
       "    'layout': {'legend': {'title': {'text': 'variable'}, 'tracegroupgap': 0},\n",
       "               'template': '...',\n",
       "               'title': {'text': 'train loss'},\n",
       "               'xaxis': {'anchor': 'y', 'domain': [0.0, 1.0], 'title': {'text': ''}},\n",
       "               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': ''}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "f9949c8d7e734c3e95edff77d792b6ca",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'e1f9c262-a5e4-4f19-98f0-34ee3b0f481c',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.55479081e+00, 2.62775267e+00, 2.57992898e+00, ..., 1.30633719e-03,\n",
       "                          2.82553991e-06, 1.02785529e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': '018edfbb-8734-4adb-8168-f4255faecdf8',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.32498504, 2.45949011, 2.49760679, ..., 0.05770284, 0.0676425 ,\n",
       "                          0.09333811])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': '722a0ffd-f493-4ec3-918f-04ed4c366549',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.41927484, 2.35970615, 2.48160438, ..., 0.08946303, 0.11314789,\n",
       "                          0.14158399])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': '5dcddde0-9175-4938-9ede-3c1c4d39619e',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.4309821 , 2.48982624, 2.45996502, ..., 0.08157461, 0.07394971,\n",
       "                          0.10965384])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'a3914824-a0a7-4549-90b8-b60ab487a520',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.53902689, 2.38007887, 2.56887524, ..., 0.03942488, 0.0243297 ,\n",
       "                          0.02355752])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'ab358294-e1f7-4ce8-a308-effe86d41aa7',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.37983882e+00, 2.38017095e+00, 2.38699892e+00, ..., 1.30102686e-03,\n",
       "                          6.37148213e-04, 6.95087677e-04])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'db00d84e-e89e-4535-8ef2-36a1af109b31',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': [2.441483083948224, 2.44950416587491, 2.4958298868558204, ...,\n",
       "                    0.04512878913520536, 0.04661829774733998, 0.06164273354724749]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data)'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'Loss'}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "175db28f4f504d04aca63ae06263dae9",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': '8efd25bc-b6ba-4d32-ade7-d07f596a3fcd',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.55479081e+00, 2.62775267e+00, 2.57992898e+00, ..., 1.30633719e-03,\n",
       "                          2.82553991e-06, 1.02785529e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'fb341363-9026-48ad-935f-d8f776e716d8',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.32498504, 2.45949011, 2.49760679, ..., 0.05770284, 0.0676425 ,\n",
       "                          0.09333811])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'aab52434-8a0d-484f-bf51-83747dad4456',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.41927484, 2.35970615, 2.48160438, ..., 0.08946303, 0.11314789,\n",
       "                          0.14158399])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': '7eb9c159-1fbf-4b2a-b20c-7f6cd93bdbbc',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.4309821 , 2.48982624, 2.45996502, ..., 0.08157461, 0.07394971,\n",
       "                          0.10965384])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'f981d91e-7ff1-46cb-b44c-63ffeff22a94',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.53902689, 2.38007887, 2.56887524, ..., 0.03942488, 0.0243297 ,\n",
       "                          0.02355752])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': '3f5ceb2e-a45f-4adb-bbbb-2d50f71eaa4a',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.37983882e+00, 2.38017095e+00, 2.38699892e+00, ..., 1.30102686e-03,\n",
       "                          6.37148213e-04, 6.95087677e-04])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': '7bb3a52b-4076-4bfe-8206-e9a5aa1df7b3',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': [2.441483083948224, 2.44950416587491, 2.4958298868558204, ...,\n",
       "                    0.04512878913520536, 0.04661829774733998, 0.06164273354724749]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data) - Log Y Axis'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'log Loss'}, 'type': 'log'}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "train(is_finite=False, d_model=64, d_mlp=128, num_epochs=50_000, checkpoint_every=1000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "75870912-3222-465b-b2f6-15ee34d09636",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "creating new model d_model=128 d_mlp=64 d_head=32 num_layers=1 num_heads=4\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "cb537be6947843179ccd049cc7601185",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/50000 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 loss=2.4516199030954775 accuracy=0.09635416666666667\n",
      "100 loss=2.1284303201374564 accuracy=0.1796875\n",
      "200 loss=2.0136356549969485 accuracy=0.22916666666666666\n",
      "300 loss=2.0063292366400844 accuracy=0.21354166666666666\n",
      "400 loss=2.004388103508761 accuracy=0.21614583333333334\n",
      "500 loss=2.0009012172212186 accuracy=0.17708333333333334\n",
      "600 loss=1.9700055267669798 accuracy=0.22395833333333334\n",
      "700 loss=1.9471296506013447 accuracy=0.2265625\n",
      "800 loss=1.9135996080924063 accuracy=0.2760416666666667\n",
      "900 loss=1.9122379979132156 accuracy=0.24739583333333334\n",
      "1000 loss=1.9142660324322898 accuracy=0.2526041666666667\n",
      "1100 loss=1.900970683010911 accuracy=0.2838541666666667\n",
      "1200 loss=1.889478351529551 accuracy=0.2421875\n",
      "1300 loss=1.8692975908253775 accuracy=0.2630208333333333\n",
      "1400 loss=1.8678945994005605 accuracy=0.2526041666666667\n",
      "1500 loss=1.855564806094706 accuracy=0.24739583333333334\n",
      "1600 loss=1.8229917478273896 accuracy=0.2734375\n",
      "1700 loss=1.8145306987268226 accuracy=0.2734375\n",
      "1800 loss=1.8044334024888742 accuracy=0.3125\n",
      "1900 loss=1.78388474999735 accuracy=0.3229166666666667\n",
      "2000 loss=1.7615669515130303 accuracy=0.3359375\n",
      "2100 loss=1.7547217507854092 accuracy=0.3515625\n",
      "2200 loss=1.7479268078898906 accuracy=0.3385416666666667\n",
      "2300 loss=1.7035978433792391 accuracy=0.3723958333333333\n",
      "2400 loss=1.6985725776310994 accuracy=0.3645833333333333\n",
      "2500 loss=1.6905320281845082 accuracy=0.3802083333333333\n",
      "2600 loss=1.6902585411658448 accuracy=0.3776041666666667\n",
      "2700 loss=1.6839261252437832 accuracy=0.3619791666666667\n",
      "2800 loss=1.6802135975257335 accuracy=0.3723958333333333\n",
      "2900 loss=1.6782743736094634 accuracy=0.3645833333333333\n",
      "3000 loss=1.6629768826938012 accuracy=0.3958333333333333\n",
      "3100 loss=1.6506273071859685 accuracy=0.3958333333333333\n",
      "3200 loss=1.6501838839415162 accuracy=0.3932291666666667\n",
      "3300 loss=1.6501379193043189 accuracy=0.375\n",
      "3400 loss=1.6269948939267966 accuracy=0.3802083333333333\n",
      "3500 loss=1.630810088824965 accuracy=0.4088541666666667\n",
      "3600 loss=1.6240757196723046 accuracy=0.3697916666666667\n",
      "3700 loss=1.6315020571418242 accuracy=0.3854166666666667\n",
      "3800 loss=1.6135116958092928 accuracy=0.3880208333333333\n",
      "3900 loss=1.6291677306836703 accuracy=0.359375\n",
      "4000 loss=1.621996646308062 accuracy=0.3854166666666667\n",
      "4100 loss=1.6132669525813212 accuracy=0.3776041666666667\n",
      "4200 loss=1.6133253398408016 accuracy=0.3802083333333333\n",
      "4300 loss=1.6018475982908005 accuracy=0.390625\n",
      "4400 loss=1.6140312835288362 accuracy=0.4296875\n",
      "4500 loss=1.577478088519881 accuracy=0.4244791666666667\n",
      "4600 loss=1.5259426350202123 accuracy=0.4453125\n",
      "4700 loss=1.528688273053798 accuracy=0.421875\n",
      "4800 loss=1.5319653355973641 accuracy=0.4270833333333333\n",
      "4900 loss=1.4760886041864811 accuracy=0.4739583333333333\n",
      "5000 loss=1.4899346387457328 accuracy=0.453125\n",
      "5100 loss=1.4387722981040352 accuracy=0.4921875\n",
      "5200 loss=1.4316902258865227 accuracy=0.4765625\n",
      "5300 loss=1.414738303321321 accuracy=0.4765625\n",
      "5400 loss=1.4265879916289308 accuracy=0.484375\n",
      "5500 loss=1.3944393840930476 accuracy=0.4609375\n",
      "5600 loss=1.3986248605523361 accuracy=0.4817708333333333\n",
      "5700 loss=1.3798989027173474 accuracy=0.484375\n",
      "5800 loss=1.3788412500066172 accuracy=0.4973958333333333\n",
      "5900 loss=1.3602439347697062 accuracy=0.5416666666666666\n",
      "6000 loss=1.3433120965212526 accuracy=0.515625\n",
      "6100 loss=1.3655656813761063 accuracy=0.484375\n",
      "6200 loss=1.3185143259489918 accuracy=0.5234375\n",
      "6300 loss=1.3320201713352244 accuracy=0.5104166666666666\n",
      "6400 loss=1.343336146662523 accuracy=0.5078125\n",
      "6500 loss=1.3189405729275998 accuracy=0.4947916666666667\n",
      "6600 loss=1.2883956800708147 accuracy=0.53125\n",
      "6700 loss=1.3143646715011192 accuracy=0.5182291666666666\n",
      "6800 loss=1.2987684074164876 accuracy=0.53125\n",
      "6900 loss=1.3047118021700321 accuracy=0.5208333333333334\n",
      "7000 loss=1.3190879796834842 accuracy=0.5208333333333334\n",
      "7100 loss=1.282182698354249 accuracy=0.5260416666666666\n",
      "7200 loss=1.2898479854252471 accuracy=0.5416666666666666\n",
      "7300 loss=1.2655806944533017 accuracy=0.5598958333333334\n",
      "7400 loss=1.287557817296816 accuracy=0.5234375\n",
      "7500 loss=1.2926714378301034 accuracy=0.5260416666666666\n",
      "7600 loss=1.250326434952003 accuracy=0.5494791666666666\n",
      "7700 loss=1.2626344887561878 accuracy=0.546875\n",
      "7800 loss=1.2619070648280917 accuracy=0.5442708333333334\n",
      "7900 loss=1.2880489478496568 accuracy=0.5234375\n",
      "8000 loss=1.2787359859990615 accuracy=0.5338541666666666\n",
      "8100 loss=1.2644232929732195 accuracy=0.53125\n",
      "8200 loss=1.299411475890971 accuracy=0.515625\n",
      "8300 loss=1.2562656461328214 accuracy=0.5416666666666666\n",
      "8400 loss=1.255125118884177 accuracy=0.515625\n",
      "8500 loss=1.2603030141085683 accuracy=0.5286458333333334\n",
      "8600 loss=1.2260425972148568 accuracy=0.5677083333333334\n",
      "8700 loss=1.2581452306769692 accuracy=0.5104166666666666\n",
      "8800 loss=1.27119379879122 accuracy=0.5390625\n",
      "8900 loss=1.237781904293038 accuracy=0.5338541666666666\n",
      "9000 loss=1.248755394073945 accuracy=0.515625\n",
      "9100 loss=1.2514068954542048 accuracy=0.53125\n",
      "9200 loss=1.2377467577888437 accuracy=0.5416666666666666\n",
      "9300 loss=1.2501623276281215 accuracy=0.5104166666666666\n",
      "9400 loss=1.2414811275087425 accuracy=0.5572916666666666\n",
      "9500 loss=1.2260850548419786 accuracy=0.546875\n",
      "9600 loss=1.2295824236529767 accuracy=0.5442708333333334\n",
      "9700 loss=1.241821440395286 accuracy=0.5494791666666666\n",
      "9800 loss=1.2426665143486568 accuracy=0.5338541666666666\n",
      "9900 loss=1.230367935248681 accuracy=0.5338541666666666\n",
      "10000 loss=1.2406099437015001 accuracy=0.5234375\n",
      "10100 loss=1.2393349839681125 accuracy=0.5520833333333334\n",
      "10200 loss=1.250393700122019 accuracy=0.5338541666666666\n",
      "10300 loss=1.2273265927492498 accuracy=0.5520833333333334\n",
      "10400 loss=1.227614545489192 accuracy=0.5494791666666666\n",
      "10500 loss=1.2237425979887369 accuracy=0.5494791666666666\n",
      "10600 loss=1.2349885489217425 accuracy=0.5182291666666666\n",
      "10700 loss=1.23447685669641 accuracy=0.53125\n",
      "10800 loss=1.2146594506633268 accuracy=0.5572916666666666\n",
      "10900 loss=1.2531166827826932 accuracy=0.5338541666666666\n",
      "11000 loss=1.2134548354013774 accuracy=0.5520833333333334\n",
      "11100 loss=1.2076382485171013 accuracy=0.5625\n",
      "11200 loss=1.2156297011110866 accuracy=0.5416666666666666\n",
      "11300 loss=1.230014869201608 accuracy=0.5338541666666666\n",
      "11400 loss=1.2239803962146323 accuracy=0.5546875\n",
      "11500 loss=1.2360873047275533 accuracy=0.5260416666666666\n",
      "11600 loss=1.2413880823980943 accuracy=0.5104166666666666\n",
      "11700 loss=1.2249401995429237 accuracy=0.5130208333333334\n",
      "11800 loss=1.2614997410964452 accuracy=0.5208333333333334\n",
      "11900 loss=1.2134611655731289 accuracy=0.546875\n",
      "12000 loss=1.2047162797758713 accuracy=0.5364583333333334\n",
      "12100 loss=1.209295625412555 accuracy=0.5130208333333334\n",
      "12200 loss=1.2207664046291624 accuracy=0.5390625\n",
      "12300 loss=1.2251165490882843 accuracy=0.5677083333333334\n",
      "12400 loss=1.203152677366829 accuracy=0.5625\n",
      "12500 loss=1.2329100624093243 accuracy=0.5494791666666666\n",
      "12600 loss=1.2022478417716216 accuracy=0.53125\n",
      "12700 loss=1.198102885560053 accuracy=0.5572916666666666\n",
      "12800 loss=1.2136690646155979 accuracy=0.5494791666666666\n",
      "12900 loss=1.189236643043659 accuracy=0.5416666666666666\n",
      "13000 loss=1.2071320484125636 accuracy=0.5416666666666666\n",
      "13100 loss=1.2230363874209094 accuracy=0.515625\n",
      "13200 loss=1.2231038234291882 accuracy=0.5338541666666666\n",
      "13300 loss=1.2163427995340097 accuracy=0.5208333333333334\n",
      "13400 loss=1.2020726724967847 accuracy=0.5364583333333334\n",
      "13500 loss=1.19715710636478 accuracy=0.5416666666666666\n",
      "13600 loss=1.2175180744028078 accuracy=0.5572916666666666\n",
      "13700 loss=1.2190064919967507 accuracy=0.5442708333333334\n",
      "13800 loss=1.2026342825843512 accuracy=0.5494791666666666\n",
      "13900 loss=1.1874261703717361 accuracy=0.5572916666666666\n",
      "14000 loss=1.1714007720464954 accuracy=0.5546875\n",
      "14100 loss=1.2034615554921038 accuracy=0.5286458333333334\n",
      "14200 loss=1.1780654808936728 accuracy=0.5651041666666666\n",
      "14300 loss=1.172154338124541 accuracy=0.5546875\n",
      "14400 loss=1.1986808082510523 accuracy=0.5703125\n",
      "14500 loss=1.1758132873603229 accuracy=0.5885416666666666\n",
      "14600 loss=1.1490767554147927 accuracy=0.5885416666666666\n",
      "14700 loss=1.17900028372223 accuracy=0.5546875\n",
      "14800 loss=1.1474986930380617 accuracy=0.5572916666666666\n",
      "14900 loss=1.115677795842 accuracy=0.5911458333333334\n",
      "15000 loss=1.0287153281389587 accuracy=0.625\n",
      "15100 loss=0.9931547696631094 accuracy=0.6223958333333334\n",
      "15200 loss=0.8656744429306388 accuracy=0.6510416666666666\n",
      "15300 loss=0.810821187135685 accuracy=0.7083333333333334\n",
      "15400 loss=0.7711640564720891 accuracy=0.75\n",
      "15500 loss=0.690208403588187 accuracy=0.7838541666666666\n",
      "15600 loss=0.6747239431382914 accuracy=0.7890625\n",
      "15700 loss=0.6269712621584135 accuracy=0.7760416666666666\n",
      "15800 loss=0.6537014208136661 accuracy=0.7890625\n",
      "15900 loss=0.6014338981040246 accuracy=0.7890625\n",
      "16000 loss=0.5726381704600028 accuracy=0.8151041666666666\n",
      "16100 loss=0.5632621117503638 accuracy=0.7942708333333334\n",
      "16200 loss=0.5635968969075513 accuracy=0.796875\n",
      "16300 loss=0.5322459294711335 accuracy=0.8072916666666666\n",
      "16400 loss=0.5556266783413795 accuracy=0.8125\n",
      "16500 loss=0.5416262429767165 accuracy=0.8046875\n",
      "16600 loss=0.5248251544119279 accuracy=0.8046875\n",
      "16700 loss=0.550285733398954 accuracy=0.7916666666666666\n",
      "16800 loss=0.5277316571645676 accuracy=0.8020833333333334\n",
      "16900 loss=0.5228667669216731 accuracy=0.8072916666666666\n",
      "17000 loss=0.5076219325083255 accuracy=0.8151041666666666\n",
      "17100 loss=0.5164544211194209 accuracy=0.8151041666666666\n",
      "17200 loss=0.5039642057986845 accuracy=0.8072916666666666\n",
      "17300 loss=0.48445943438848876 accuracy=0.8255208333333334\n",
      "17400 loss=0.48107258964453414 accuracy=0.8151041666666666\n",
      "17500 loss=0.475309111148025 accuracy=0.8229166666666666\n",
      "17600 loss=0.47649687841306526 accuracy=0.8359375\n",
      "17700 loss=0.43012691793785357 accuracy=0.8489583333333334\n",
      "17800 loss=0.4680169532266905 accuracy=0.8229166666666666\n",
      "17900 loss=0.4075451064251141 accuracy=0.8541666666666666\n",
      "18000 loss=0.4228189706840311 accuracy=0.859375\n",
      "18100 loss=0.41201796799748724 accuracy=0.8489583333333334\n",
      "18200 loss=0.38297509222562154 accuracy=0.8489583333333334\n",
      "18300 loss=0.37949320427281547 accuracy=0.8489583333333334\n",
      "18400 loss=0.3467068015199846 accuracy=0.8671875\n",
      "18500 loss=0.33417314039954366 accuracy=0.8776041666666666\n",
      "18600 loss=0.2658027788305052 accuracy=0.8932291666666666\n",
      "18700 loss=0.24941653340011874 accuracy=0.9036458333333334\n",
      "18800 loss=0.2519814715550389 accuracy=0.8958333333333334\n",
      "18900 loss=0.23531487095580342 accuracy=0.9036458333333334\n",
      "19000 loss=0.20556920262172335 accuracy=0.9010416666666666\n",
      "19100 loss=0.20193818622351217 accuracy=0.9036458333333334\n",
      "19200 loss=0.22019367148613914 accuracy=0.9088541666666666\n",
      "19300 loss=0.2141031552634513 accuracy=0.890625\n",
      "19400 loss=0.2023881958898607 accuracy=0.9322916666666666\n",
      "19500 loss=0.19267145422002768 accuracy=0.9296875\n",
      "19600 loss=0.18866098049934626 accuracy=0.9296875\n",
      "19700 loss=0.17969937526853969 accuracy=0.921875\n",
      "19800 loss=0.15825764828245265 accuracy=0.953125\n",
      "19900 loss=0.1397738528475002 accuracy=0.9635416666666666\n",
      "20000 loss=0.14482621403244617 accuracy=0.9401041666666666\n",
      "20100 loss=0.14841753917710326 accuracy=0.9348958333333334\n",
      "20200 loss=0.13851389837565975 accuracy=0.9609375\n",
      "20300 loss=0.1630998955838584 accuracy=0.9401041666666666\n",
      "20400 loss=0.14078765666791113 accuracy=0.9557291666666666\n",
      "20500 loss=0.13706806045140496 accuracy=0.9348958333333334\n",
      "20600 loss=0.1235962869912592 accuracy=0.9635416666666666\n",
      "20700 loss=0.12151740675127454 accuracy=0.9609375\n",
      "20800 loss=0.13278898467704073 accuracy=0.9505208333333334\n",
      "20900 loss=0.1256533358694672 accuracy=0.9583333333333334\n",
      "21000 loss=0.1457270753741303 accuracy=0.9505208333333334\n",
      "21100 loss=0.10826017806379296 accuracy=0.9817708333333334\n",
      "21200 loss=0.12311241687739474 accuracy=0.9609375\n",
      "21300 loss=0.1087732832061013 accuracy=0.9635416666666666\n",
      "21400 loss=0.11865729574789459 accuracy=0.9583333333333334\n",
      "21500 loss=0.1411396440774859 accuracy=0.9609375\n",
      "21600 loss=0.09884851206049197 accuracy=0.9713541666666666\n",
      "21700 loss=0.10940255848177374 accuracy=0.9661458333333334\n",
      "21800 loss=0.11802493422580096 accuracy=0.953125\n",
      "21900 loss=0.11576904837430929 accuracy=0.9609375\n",
      "22000 loss=0.10113970055318118 accuracy=0.96875\n",
      "22100 loss=0.11716243858742238 accuracy=0.953125\n",
      "22200 loss=0.0948664393837585 accuracy=0.96875\n",
      "22300 loss=0.09697759819552411 accuracy=0.9713541666666666\n",
      "22400 loss=0.09606930615054549 accuracy=0.96875\n",
      "22500 loss=0.09804795195266225 accuracy=0.9635416666666666\n",
      "22600 loss=0.11886925079759182 accuracy=0.9609375\n",
      "22700 loss=0.09857309960018573 accuracy=0.9661458333333334\n",
      "22800 loss=0.11226195435159228 accuracy=0.9583333333333334\n",
      "22900 loss=0.10110714873439455 accuracy=0.96875\n",
      "23000 loss=0.11178959151350105 accuracy=0.9609375\n",
      "23100 loss=0.11409297954493892 accuracy=0.9453125\n",
      "23200 loss=0.10302082927256517 accuracy=0.9713541666666666\n",
      "23300 loss=0.11213904284551914 accuracy=0.9583333333333334\n",
      "23400 loss=0.1123799137977034 accuracy=0.9635416666666666\n",
      "23500 loss=0.09144622063003144 accuracy=0.96875\n",
      "23600 loss=0.12105111885977796 accuracy=0.9348958333333334\n",
      "23700 loss=0.0990344023755575 accuracy=0.9661458333333334\n",
      "23800 loss=0.09805876145701045 accuracy=0.9661458333333334\n",
      "23900 loss=0.10201870928648367 accuracy=0.9739583333333334\n",
      "24000 loss=0.10174965686207332 accuracy=0.9661458333333334\n",
      "24100 loss=0.08845781880307113 accuracy=0.9739583333333334\n",
      "24200 loss=0.09514147459388936 accuracy=0.9713541666666666\n",
      "24300 loss=0.10342317640749173 accuracy=0.9661458333333334\n",
      "24400 loss=0.10661839802131182 accuracy=0.9557291666666666\n",
      "24500 loss=0.0878427219638799 accuracy=0.9635416666666666\n",
      "24600 loss=0.08960790197968746 accuracy=0.9661458333333334\n",
      "24700 loss=0.10910551824395588 accuracy=0.96875\n",
      "24800 loss=0.08420107841278662 accuracy=0.9791666666666666\n",
      "24900 loss=0.07869600524577758 accuracy=0.9791666666666666\n",
      "25000 loss=0.08381634341905131 accuracy=0.984375\n",
      "25100 loss=0.12371180506739715 accuracy=0.9557291666666666\n",
      "25200 loss=0.08846754340782173 accuracy=0.9739583333333334\n",
      "25300 loss=0.07811604432949372 accuracy=0.9817708333333334\n",
      "25400 loss=0.1028990131404593 accuracy=0.9661458333333334\n",
      "25500 loss=0.07213563244522239 accuracy=0.9765625\n",
      "25600 loss=0.08255456414188338 accuracy=0.9713541666666666\n",
      "25700 loss=0.08533782529464123 accuracy=0.9661458333333334\n",
      "25800 loss=0.08239893713266552 accuracy=0.9557291666666666\n",
      "25900 loss=0.09191091669496013 accuracy=0.9739583333333334\n",
      "26000 loss=0.08637964219317895 accuracy=0.9791666666666666\n",
      "26100 loss=0.09699646054932834 accuracy=0.9739583333333334\n",
      "26200 loss=0.09979924212045488 accuracy=0.953125\n",
      "26300 loss=0.10239991133322664 accuracy=0.953125\n",
      "26400 loss=0.07699195809227971 accuracy=0.9817708333333334\n",
      "26500 loss=0.08330985272186045 accuracy=0.9713541666666666\n",
      "26600 loss=0.07545407175254623 accuracy=0.9869791666666666\n",
      "26700 loss=0.07685414265638227 accuracy=0.9817708333333334\n",
      "26800 loss=0.0787739512167935 accuracy=0.9765625\n",
      "26900 loss=0.0669940346432065 accuracy=0.9791666666666666\n",
      "27000 loss=0.08478583135560776 accuracy=0.9791666666666666\n",
      "27100 loss=0.10258836054216328 accuracy=0.9609375\n",
      "27200 loss=0.06926858321536031 accuracy=0.9817708333333334\n",
      "27300 loss=0.07926186988223571 accuracy=0.9765625\n",
      "27400 loss=0.08281139638458881 accuracy=0.9713541666666666\n",
      "27500 loss=0.09370832259430824 accuracy=0.9739583333333334\n",
      "27600 loss=0.06915552599641696 accuracy=0.9739583333333334\n",
      "27700 loss=0.08573643270337578 accuracy=0.9817708333333334\n",
      "27800 loss=0.0911539877634081 accuracy=0.9713541666666666\n",
      "27900 loss=0.09557675608048634 accuracy=0.9557291666666666\n",
      "28000 loss=0.07347046343639765 accuracy=0.9791666666666666\n",
      "28100 loss=0.0746861545702209 accuracy=0.9791666666666666\n",
      "28200 loss=0.08635887173638575 accuracy=0.9713541666666666\n",
      "28300 loss=0.08585230264898525 accuracy=0.9817708333333334\n",
      "28400 loss=0.08546894678202634 accuracy=0.96875\n",
      "28500 loss=0.09006613565170991 accuracy=0.9713541666666666\n",
      "28600 loss=0.07947033991497324 accuracy=0.9635416666666666\n",
      "28700 loss=0.07739363458973253 accuracy=0.9713541666666666\n",
      "28800 loss=0.06937729245706764 accuracy=0.9765625\n",
      "28900 loss=0.08943027323024007 accuracy=0.9791666666666666\n",
      "29000 loss=0.05961258141600753 accuracy=0.9869791666666666\n",
      "29100 loss=0.08836686312615823 accuracy=0.9661458333333334\n",
      "29200 loss=0.11425067329437547 accuracy=0.9609375\n",
      "29300 loss=0.07427759319109037 accuracy=0.9713541666666666\n",
      "29400 loss=0.0757798296858352 accuracy=0.9739583333333334\n",
      "29500 loss=0.08936140958322544 accuracy=0.9661458333333334\n",
      "29600 loss=0.0835659652147697 accuracy=0.96875\n",
      "29700 loss=0.07504152074981814 accuracy=0.9765625\n",
      "29800 loss=0.0891436136630346 accuracy=0.9713541666666666\n",
      "29900 loss=0.07512430888975391 accuracy=0.9765625\n",
      "30000 loss=0.08584657303080306 accuracy=0.9713541666666666\n",
      "30100 loss=0.07986458467265957 accuracy=0.9817708333333334\n",
      "30200 loss=0.0840112200203415 accuracy=0.9765625\n",
      "30300 loss=0.08641288562542976 accuracy=0.9817708333333334\n",
      "30400 loss=0.07068547581887935 accuracy=0.9713541666666666\n",
      "30500 loss=0.06716407395352285 accuracy=0.984375\n",
      "30600 loss=0.08125353977687633 accuracy=0.9713541666666666\n",
      "30700 loss=0.0755517090201798 accuracy=0.9791666666666666\n",
      "30800 loss=0.08394238528036724 accuracy=0.9765625\n",
      "30900 loss=0.10775801908001055 accuracy=0.9661458333333334\n",
      "31000 loss=0.07934936505852977 accuracy=0.9739583333333334\n",
      "31100 loss=0.07688925518770973 accuracy=0.96875\n",
      "31200 loss=0.07174866924752599 accuracy=0.9765625\n",
      "31300 loss=0.06643842833222888 accuracy=0.9817708333333334\n",
      "31400 loss=0.06846484105183272 accuracy=0.9713541666666666\n",
      "31500 loss=0.08983065739581844 accuracy=0.96875\n",
      "31600 loss=0.07483254053229949 accuracy=0.984375\n",
      "31700 loss=0.08764670013145018 accuracy=0.9713541666666666\n",
      "31800 loss=0.07699032268260297 accuracy=0.9713541666666666\n",
      "31900 loss=0.06615915108117361 accuracy=0.9817708333333334\n",
      "32000 loss=0.08743821190239423 accuracy=0.9661458333333334\n",
      "32100 loss=0.07660153932463307 accuracy=0.9739583333333334\n",
      "32200 loss=0.086557971334988 accuracy=0.9713541666666666\n",
      "32300 loss=0.07246471357257114 accuracy=0.9739583333333334\n",
      "32400 loss=0.07659495884571024 accuracy=0.9765625\n",
      "32500 loss=0.07085818799405466 accuracy=0.9791666666666666\n",
      "32600 loss=0.09301834445202907 accuracy=0.953125\n",
      "32700 loss=0.05981966315931368 accuracy=0.9791666666666666\n",
      "32800 loss=0.06297288406755322 accuracy=0.9895833333333334\n",
      "32900 loss=0.08303178656230675 accuracy=0.96875\n",
      "33000 loss=0.0741158862912157 accuracy=0.9791666666666666\n",
      "33100 loss=0.07177257539531451 accuracy=0.9817708333333334\n",
      "33200 loss=0.10393777299446838 accuracy=0.9609375\n",
      "33300 loss=0.08420698657375361 accuracy=0.9765625\n",
      "33400 loss=0.08080154842399363 accuracy=0.96875\n",
      "33500 loss=0.0780411003572334 accuracy=0.9713541666666666\n",
      "33600 loss=0.09435417406159265 accuracy=0.9583333333333334\n",
      "33700 loss=0.07208945252390886 accuracy=0.9869791666666666\n",
      "33800 loss=0.06810257975914272 accuracy=0.9817708333333334\n",
      "33900 loss=0.10004458621519798 accuracy=0.9557291666666666\n",
      "34000 loss=0.08580670010570002 accuracy=0.9739583333333334\n",
      "34100 loss=0.06642854599218734 accuracy=0.9869791666666666\n",
      "34200 loss=0.08106922378657128 accuracy=0.9661458333333334\n",
      "34300 loss=0.06495024103894623 accuracy=0.9765625\n",
      "34400 loss=0.07021181125400686 accuracy=0.9791666666666666\n",
      "34500 loss=0.09627352801226521 accuracy=0.9609375\n",
      "34600 loss=0.06414765872245745 accuracy=0.9895833333333334\n",
      "34700 loss=0.06229448377830774 accuracy=0.9739583333333334\n",
      "34800 loss=0.0831011566758149 accuracy=0.96875\n",
      "34900 loss=0.08417290786534848 accuracy=0.9609375\n",
      "35000 loss=0.06521525399219391 accuracy=0.984375\n",
      "35100 loss=0.05962171883173612 accuracy=0.9869791666666666\n",
      "35200 loss=0.06746783115896995 accuracy=0.9765625\n",
      "35300 loss=0.09147781339034519 accuracy=0.9713541666666666\n",
      "35400 loss=0.08294309467316041 accuracy=0.9609375\n",
      "35500 loss=0.05988674615224156 accuracy=0.9869791666666666\n",
      "35600 loss=0.0734028635097552 accuracy=0.9713541666666666\n",
      "35700 loss=0.06084111401356244 accuracy=0.984375\n",
      "35800 loss=0.06046319034787333 accuracy=0.984375\n",
      "35900 loss=0.07852067425312581 accuracy=0.9635416666666666\n",
      "36000 loss=0.07813991544065983 accuracy=0.9765625\n",
      "36100 loss=0.07991412033638834 accuracy=0.9765625\n",
      "36200 loss=0.07304432984100064 accuracy=0.96875\n",
      "36300 loss=0.06460301099524336 accuracy=0.9765625\n",
      "36400 loss=0.10582989452352548 accuracy=0.9583333333333334\n",
      "36500 loss=0.08602136858869742 accuracy=0.9713541666666666\n",
      "36600 loss=0.06515983521534942 accuracy=0.9791666666666666\n",
      "36700 loss=0.05773638872307581 accuracy=0.9765625\n",
      "36800 loss=0.06794143713004752 accuracy=0.9739583333333334\n",
      "36900 loss=0.07094218468131228 accuracy=0.9765625\n",
      "37000 loss=0.09414093282120825 accuracy=0.9583333333333334\n",
      "37100 loss=0.09908777540667768 accuracy=0.9557291666666666\n",
      "37200 loss=0.08696244104665603 accuracy=0.9661458333333334\n",
      "37300 loss=0.07298729133748696 accuracy=0.9739583333333334\n",
      "37400 loss=0.08743265173057416 accuracy=0.96875\n",
      "37500 loss=0.0910321327834336 accuracy=0.96875\n",
      "37600 loss=0.08322687811840394 accuracy=0.9739583333333334\n",
      "37700 loss=0.09282647573915122 accuracy=0.9609375\n",
      "37800 loss=0.07308455028911981 accuracy=0.9661458333333334\n",
      "37900 loss=0.06634028281011613 accuracy=0.9791666666666666\n",
      "38000 loss=0.06311348572805565 accuracy=0.9817708333333334\n",
      "38100 loss=0.06463750548017655 accuracy=0.9817708333333334\n",
      "38200 loss=0.07069658257070935 accuracy=0.9765625\n",
      "38300 loss=0.07459466129392989 accuracy=0.9791666666666666\n",
      "38400 loss=0.06808261425545555 accuracy=0.9869791666666666\n",
      "38500 loss=0.07757452430689156 accuracy=0.9791666666666666\n",
      "38600 loss=0.06605436422331729 accuracy=0.9817708333333334\n",
      "38700 loss=0.10250968526607913 accuracy=0.9479166666666666\n",
      "38800 loss=0.060958534126107446 accuracy=0.9869791666666666\n",
      "38900 loss=0.06519360840855262 accuracy=0.9817708333333334\n",
      "39000 loss=0.07162221203383831 accuracy=0.9869791666666666\n",
      "39100 loss=0.09946799907398543 accuracy=0.9583333333333334\n",
      "39200 loss=0.09027498618415572 accuracy=0.9713541666666666\n",
      "39300 loss=0.0801071985938673 accuracy=0.9739583333333334\n",
      "39400 loss=0.08452271171395359 accuracy=0.9713541666666666\n",
      "39500 loss=0.09571052528489668 accuracy=0.9739583333333334\n",
      "39600 loss=0.07991167983442543 accuracy=0.9739583333333334\n",
      "39700 loss=0.06785797010970597 accuracy=0.9765625\n",
      "39800 loss=0.0754431300094758 accuracy=0.9713541666666666\n",
      "39900 loss=0.0776447316436984 accuracy=0.9791666666666666\n",
      "40000 loss=0.06317740561964304 accuracy=0.9739583333333334\n",
      "40100 loss=0.0849701763109781 accuracy=0.96875\n",
      "40200 loss=0.06176033644685433 accuracy=0.9817708333333334\n",
      "40300 loss=0.08266830928077079 accuracy=0.9791666666666666\n",
      "40400 loss=0.07269570910888597 accuracy=0.9765625\n",
      "40500 loss=0.07724336719134521 accuracy=0.9765625\n",
      "40600 loss=0.06973620766990132 accuracy=0.9817708333333334\n",
      "40700 loss=0.07443766928648535 accuracy=0.9791666666666666\n",
      "40800 loss=0.08529468610740987 accuracy=0.9739583333333334\n",
      "40900 loss=0.0691396992205803 accuracy=0.9791666666666666\n",
      "41000 loss=0.08236492741212292 accuracy=0.9635416666666666\n",
      "41100 loss=0.059143797421886135 accuracy=0.9791666666666666\n",
      "41200 loss=0.06347038581616143 accuracy=0.9817708333333334\n",
      "41300 loss=0.07169621266102263 accuracy=0.9765625\n",
      "41400 loss=0.07999016886493061 accuracy=0.9765625\n",
      "41500 loss=0.0637248477884429 accuracy=0.9817708333333334\n",
      "41600 loss=0.07061946181130585 accuracy=0.984375\n",
      "41700 loss=0.07487992838436552 accuracy=0.9817708333333334\n",
      "41800 loss=0.058030145601449847 accuracy=0.9895833333333334\n",
      "41900 loss=0.08876946865869896 accuracy=0.9635416666666666\n",
      "42000 loss=0.09577061419625228 accuracy=0.9635416666666666\n",
      "42100 loss=0.09764169122627797 accuracy=0.9635416666666666\n",
      "42200 loss=0.07233104822683321 accuracy=0.9765625\n",
      "42300 loss=0.0896649220610648 accuracy=0.9635416666666666\n",
      "42400 loss=0.0778623641692834 accuracy=0.9713541666666666\n",
      "42500 loss=0.07110519126920553 accuracy=0.9739583333333334\n",
      "42600 loss=0.0575294942980446 accuracy=0.984375\n",
      "42700 loss=0.08932712441362663 accuracy=0.9557291666666666\n",
      "42800 loss=0.08895055380790702 accuracy=0.9713541666666666\n",
      "42900 loss=0.0612295532893022 accuracy=0.9921875\n",
      "43000 loss=0.05771512580566342 accuracy=0.9791666666666666\n",
      "43100 loss=0.07376991352478654 accuracy=0.9713541666666666\n",
      "43200 loss=0.07661741591603147 accuracy=0.9765625\n",
      "43300 loss=0.08232799926162124 accuracy=0.9661458333333334\n",
      "43400 loss=0.08666709871837952 accuracy=0.96875\n",
      "43500 loss=0.09132122555040359 accuracy=0.9635416666666666\n",
      "43600 loss=0.06130534077470341 accuracy=0.9817708333333334\n",
      "43700 loss=0.07310417188805841 accuracy=0.9713541666666666\n",
      "43800 loss=0.08852472340829098 accuracy=0.9661458333333334\n",
      "43900 loss=0.07374298284886749 accuracy=0.96875\n",
      "44000 loss=0.048340697816278436 accuracy=0.9921875\n",
      "44100 loss=0.07246287498087475 accuracy=0.9791666666666666\n",
      "44200 loss=0.054798568920714455 accuracy=0.9791666666666666\n",
      "44300 loss=0.07762517547933899 accuracy=0.9713541666666666\n",
      "44400 loss=0.07150953070856812 accuracy=0.9713541666666666\n",
      "44500 loss=0.050135586385744016 accuracy=0.9791666666666666\n",
      "44600 loss=0.06035954920066512 accuracy=0.9869791666666666\n",
      "44700 loss=0.0699697318256877 accuracy=0.9791666666666666\n",
      "44800 loss=0.07444723583299649 accuracy=0.96875\n",
      "44900 loss=0.08497720588783636 accuracy=0.96875\n",
      "45000 loss=0.06466219256841771 accuracy=0.984375\n",
      "45100 loss=0.0770393767692911 accuracy=0.984375\n",
      "45200 loss=0.08563876802421895 accuracy=0.9557291666666666\n",
      "45300 loss=0.07441463835221776 accuracy=0.9739583333333334\n",
      "45400 loss=0.07662633607020156 accuracy=0.9713541666666666\n",
      "45500 loss=0.07392158286002783 accuracy=0.9791666666666666\n",
      "45600 loss=0.07729972347235449 accuracy=0.96875\n",
      "45700 loss=0.06960160618115313 accuracy=0.9791666666666666\n",
      "45800 loss=0.07648799530958482 accuracy=0.9791666666666666\n",
      "45900 loss=0.08414591794905431 accuracy=0.96875\n",
      "46000 loss=0.07650497654353508 accuracy=0.9817708333333334\n",
      "46100 loss=0.07296904671666576 accuracy=0.9739583333333334\n",
      "46200 loss=0.08850025188240775 accuracy=0.9583333333333334\n",
      "46300 loss=0.08401835446281154 accuracy=0.9609375\n",
      "46400 loss=0.07859234695629302 accuracy=0.9765625\n",
      "46500 loss=0.06722545915152169 accuracy=0.984375\n",
      "46600 loss=0.07479794112906198 accuracy=0.984375\n",
      "46700 loss=0.06659660467445536 accuracy=0.9869791666666666\n",
      "46800 loss=0.08247334960969535 accuracy=0.9739583333333334\n",
      "46900 loss=0.04786525219279164 accuracy=0.9921875\n",
      "47000 loss=0.08204931906093685 accuracy=0.9609375\n",
      "47100 loss=0.07032885159028465 accuracy=0.9791666666666666\n",
      "47200 loss=0.061215786434404736 accuracy=0.9895833333333334\n",
      "47300 loss=0.06197084837170897 accuracy=0.9791666666666666\n",
      "47400 loss=0.07138884970653732 accuracy=0.9791666666666666\n",
      "47500 loss=0.07965570571348629 accuracy=0.9635416666666666\n",
      "47600 loss=0.06707932923817464 accuracy=0.9791666666666666\n",
      "47700 loss=0.07214320396406548 accuracy=0.9739583333333334\n",
      "47800 loss=0.0670989094013362 accuracy=0.9765625\n",
      "47900 loss=0.07641455759170682 accuracy=0.9661458333333334\n",
      "48000 loss=0.07699361017433638 accuracy=0.96875\n",
      "48100 loss=0.0611149502952011 accuracy=0.9817708333333334\n",
      "48200 loss=0.07426771300658865 accuracy=0.9765625\n",
      "48300 loss=0.0769888651427694 accuracy=0.9765625\n",
      "48400 loss=0.06829760571397148 accuracy=0.9817708333333334\n",
      "48500 loss=0.08343849822397777 accuracy=0.9713541666666666\n",
      "48600 loss=0.06897998802045141 accuracy=0.9765625\n",
      "48700 loss=0.06542038619773083 accuracy=0.9765625\n",
      "48800 loss=0.06738237023582984 accuracy=0.9765625\n",
      "48900 loss=0.06717688815543206 accuracy=0.9817708333333334\n",
      "49000 loss=0.06765680191377839 accuracy=0.9765625\n",
      "49100 loss=0.07437368683175127 accuracy=0.9713541666666666\n",
      "49200 loss=0.05458847982440135 accuracy=0.9895833333333334\n",
      "49300 loss=0.0732231109346583 accuracy=0.9791666666666666\n",
      "49400 loss=0.05413576473308513 accuracy=0.9895833333333334\n",
      "49500 loss=0.055063575699506026 accuracy=0.9817708333333334\n",
      "49600 loss=0.08995851854604991 accuracy=0.96875\n",
      "49700 loss=0.06299653033650184 accuracy=0.9817708333333334\n",
      "49800 loss=0.055225411564668384 accuracy=0.984375\n",
      "49900 loss=0.07312467225604406 accuracy=0.96875\n",
      "epoch=49999 loss=0.07082109187968355 per_token_losses=tensor([0.0010, 0.1238, 0.0974, 0.0938, 0.1066, 0.0023], dtype=torch.float64) accuracy=0.9896 per_token_accuracy=array([1.      , 0.96875 , 1.      , 0.984375, 0.984375, 1.      ])\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "acffe7839f19480b9e5ce6873189cb8a",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'hovertemplate': 'variable=0<br>index=%{x}<br>value=%{y}<extra></extra>',\n",
       "              'legendgroup': '0',\n",
       "              'line': {'color': '#636efa', 'dash': 'solid'},\n",
       "              'marker': {'symbol': 'circle'},\n",
       "              'mode': 'lines',\n",
       "              'name': '0',\n",
       "              'showlegend': True,\n",
       "              'type': 'scattergl',\n",
       "              'uid': 'c27432d3-7d7a-4595-902f-8efd7acb0958',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'xaxis': 'x',\n",
       "              'y': array([2.4516199 , 2.44175296, 2.45412222, ..., 0.05901789, 0.07390825,\n",
       "                          0.07082109]),\n",
       "              'yaxis': 'y'}],\n",
       "    'layout': {'legend': {'title': {'text': 'variable'}, 'tracegroupgap': 0},\n",
       "               'template': '...',\n",
       "               'title': {'text': 'train loss'},\n",
       "               'xaxis': {'anchor': 'y', 'domain': [0.0, 1.0], 'title': {'text': ''}},\n",
       "               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': ''}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "b0f2ce77337c4d50bd1f7315a6797f85",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'f7d0bf8b-f43a-405e-b826-c71f3e90c5be',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.63743297e+00, 2.67449203e+00, 2.64059423e+00, ..., 4.12668895e-04,\n",
       "                          3.15157098e-04, 1.01534865e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'ab85201d-7563-47c1-9077-c7205c42cf46',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.53536207, 2.47970824, 2.33973451, ..., 0.0435668 , 0.09335388,\n",
       "                          0.1237882 ])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': '6153472e-7405-4e5c-abd1-1eec7d9abeb3',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.46110646, 2.48549139, 2.52896034, ..., 0.12309423, 0.12419233,\n",
       "                          0.09735335])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'e83d1414-d12e-4b63-ba62-715020602170',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.33690207, 2.28348591, 2.3857626 , ..., 0.07741983, 0.12371342,\n",
       "                          0.09383173])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'c8914445-abc3-4aa7-85dc-99c562d33cb8',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.36134025, 2.36127799, 2.42796501, ..., 0.10213452, 0.10074118,\n",
       "                          0.10662162])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': '80d94d3f-16aa-40f9-b773-6193153fcc02',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.37757559e+00, 2.36606220e+00, 2.40171665e+00, ..., 7.47928122e-03,\n",
       "                          1.13354497e-03, 2.31630184e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'd221d91e-98e9-4a16-b0cb-6097ef770cd3',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': [2.4516199030954775, 2.4417529596239262, 2.4541222239132354,\n",
       "                    ..., 0.05901788698072945, 0.07390825130592224,\n",
       "                    0.07082109187968355]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data)'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'Loss'}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "56b6ae8ab48e405790f5c40cc5ea24ab",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': '42f99d2e-f8c4-40b2-bc73-c201db1f98af',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.63743297e+00, 2.67449203e+00, 2.64059423e+00, ..., 4.12668895e-04,\n",
       "                          3.15157098e-04, 1.01534865e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'f4657b10-ea53-4ccc-8c92-bac18ac5613c',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.53536207, 2.47970824, 2.33973451, ..., 0.0435668 , 0.09335388,\n",
       "                          0.1237882 ])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': '6f5071a1-5a7c-4687-a7f0-97ba9aee94d0',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.46110646, 2.48549139, 2.52896034, ..., 0.12309423, 0.12419233,\n",
       "                          0.09735335])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'e4cdf7dd-34a0-491c-92fa-2ea572e1b75c',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.33690207, 2.28348591, 2.3857626 , ..., 0.07741983, 0.12371342,\n",
       "                          0.09383173])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': '7df00221-31d5-474c-93dd-1e4fa42f3194',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.36134025, 2.36127799, 2.42796501, ..., 0.10213452, 0.10074118,\n",
       "                          0.10662162])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': '586e9be0-22e1-432e-adce-0e2c5c60c7c5',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': array([2.37757559e+00, 2.36606220e+00, 2.40171665e+00, ..., 7.47928122e-03,\n",
       "                          1.13354497e-03, 2.31630184e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'dad4323a-db0a-4f44-9d0c-a8314e85322e',\n",
       "              'x': array([    0,     1,     2, ..., 49997, 49998, 49999]),\n",
       "              'y': [2.4516199030954775, 2.4417529596239262, 2.4541222239132354,\n",
       "                    ..., 0.05901788698072945, 0.07390825130592224,\n",
       "                    0.07082109187968355]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data) - Log Y Axis'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'log Loss'}, 'type': 'log'}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "train(is_finite=False, d_model=128, d_mlp=64, num_epochs=50_000, checkpoint_every=1000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "42643e70-2ca4-43bb-87a8-a72def6fefd9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "creating new model d_model=64 d_mlp=64 d_head=16 num_layers=1 num_heads=4\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "049ea07ef8f4455e83fa7f524601fe6c",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/60000 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 loss=2.4348465010350244 accuracy=0.09895833333333333\n",
      "100 loss=2.147776479767871 accuracy=0.18229166666666666\n",
      "200 loss=2.0606869183669945 accuracy=0.2109375\n",
      "300 loss=2.0205761808982055 accuracy=0.2109375\n",
      "400 loss=2.0276691990494893 accuracy=0.20833333333333334\n",
      "500 loss=2.01552459444264 accuracy=0.17447916666666666\n",
      "600 loss=2.004030048550482 accuracy=0.21875\n",
      "700 loss=1.9961215127703458 accuracy=0.203125\n",
      "800 loss=1.9911894298838597 accuracy=0.2109375\n",
      "900 loss=1.9828466824745639 accuracy=0.23177083333333334\n",
      "1000 loss=1.9849958182104372 accuracy=0.22916666666666666\n",
      "1100 loss=1.9801904202702132 accuracy=0.23177083333333334\n",
      "1200 loss=1.9674932136165455 accuracy=0.23697916666666666\n",
      "1300 loss=1.926700510525217 accuracy=0.2760416666666667\n",
      "1400 loss=1.9151975339527842 accuracy=0.2604166666666667\n",
      "1500 loss=1.9067918455779571 accuracy=0.2604166666666667\n",
      "1600 loss=1.8878887271520068 accuracy=0.28125\n",
      "1700 loss=1.915256465151133 accuracy=0.22916666666666666\n",
      "1800 loss=1.9078444129624854 accuracy=0.24739583333333334\n",
      "1900 loss=1.904682184883212 accuracy=0.2578125\n",
      "2000 loss=1.8877987766492739 accuracy=0.2786458333333333\n",
      "2100 loss=1.8881687319330862 accuracy=0.2421875\n",
      "2200 loss=1.8799031498850651 accuracy=0.3046875\n",
      "2300 loss=1.8584751349167719 accuracy=0.2734375\n",
      "2400 loss=1.8721338238483158 accuracy=0.2838541666666667\n",
      "2500 loss=1.8394443106065888 accuracy=0.2942708333333333\n",
      "2600 loss=1.8264255904380269 accuracy=0.2916666666666667\n",
      "2700 loss=1.807120274915159 accuracy=0.3203125\n",
      "2800 loss=1.80241285267285 accuracy=0.3203125\n",
      "2900 loss=1.8223050713033715 accuracy=0.2916666666666667\n",
      "3000 loss=1.7831967609095951 accuracy=0.3046875\n",
      "3100 loss=1.766835155724585 accuracy=0.3177083333333333\n",
      "3200 loss=1.7720929968567845 accuracy=0.3411458333333333\n",
      "3300 loss=1.764172394278074 accuracy=0.3359375\n",
      "3400 loss=1.7457922066711469 accuracy=0.3541666666666667\n",
      "3500 loss=1.7497310069607188 accuracy=0.3463541666666667\n",
      "3600 loss=1.727689649964871 accuracy=0.3645833333333333\n",
      "3700 loss=1.7148838279085283 accuracy=0.3463541666666667\n",
      "3800 loss=1.7259532724701665 accuracy=0.3411458333333333\n",
      "3900 loss=1.7001472491567413 accuracy=0.3697916666666667\n",
      "4000 loss=1.7376548737220943 accuracy=0.3411458333333333\n",
      "4100 loss=1.7017905512484897 accuracy=0.3880208333333333\n",
      "4200 loss=1.6940156963834074 accuracy=0.3828125\n",
      "4300 loss=1.6790869756845415 accuracy=0.375\n",
      "4400 loss=1.7008141869128384 accuracy=0.34375\n",
      "4500 loss=1.690441537367374 accuracy=0.3463541666666667\n",
      "4600 loss=1.671556969709068 accuracy=0.3723958333333333\n",
      "4700 loss=1.6755567746853846 accuracy=0.3880208333333333\n",
      "4800 loss=1.6843062040627097 accuracy=0.3567708333333333\n",
      "4900 loss=1.6562251580933967 accuracy=0.390625\n",
      "5000 loss=1.649647928452429 accuracy=0.359375\n",
      "5100 loss=1.653118284267704 accuracy=0.3645833333333333\n",
      "5200 loss=1.659913431081286 accuracy=0.3854166666666667\n",
      "5300 loss=1.6510031236326825 accuracy=0.40625\n",
      "5400 loss=1.6433836963473332 accuracy=0.40625\n",
      "5500 loss=1.6653713354013973 accuracy=0.3515625\n",
      "5600 loss=1.6260156970491364 accuracy=0.40625\n",
      "5700 loss=1.643306625715352 accuracy=0.375\n",
      "5800 loss=1.6532341353145013 accuracy=0.375\n",
      "5900 loss=1.6396208516801727 accuracy=0.3723958333333333\n",
      "6000 loss=1.6360888123138349 accuracy=0.3828125\n",
      "6100 loss=1.6517803538048237 accuracy=0.359375\n",
      "6200 loss=1.6213620223761596 accuracy=0.3723958333333333\n",
      "6300 loss=1.6260569984170492 accuracy=0.3723958333333333\n",
      "6400 loss=1.6210143362529292 accuracy=0.3880208333333333\n",
      "6500 loss=1.6203467315120363 accuracy=0.3932291666666667\n",
      "6600 loss=1.6291305284014383 accuracy=0.3776041666666667\n",
      "6700 loss=1.6145260565430768 accuracy=0.3776041666666667\n",
      "6800 loss=1.608914397329292 accuracy=0.3958333333333333\n",
      "6900 loss=1.6186620203883701 accuracy=0.3932291666666667\n",
      "7000 loss=1.613913203408719 accuracy=0.40625\n",
      "7100 loss=1.6192846015743032 accuracy=0.3776041666666667\n",
      "7200 loss=1.6144334920855834 accuracy=0.3697916666666667\n",
      "7300 loss=1.6000493066734123 accuracy=0.3984375\n",
      "7400 loss=1.6110874517431306 accuracy=0.3671875\n",
      "7500 loss=1.613981539456494 accuracy=0.3958333333333333\n",
      "7600 loss=1.6025856907544382 accuracy=0.3854166666666667\n",
      "7700 loss=1.6100195701239015 accuracy=0.3776041666666667\n",
      "7800 loss=1.6029344664799865 accuracy=0.3854166666666667\n",
      "7900 loss=1.601585096195294 accuracy=0.3828125\n",
      "8000 loss=1.5846117889983866 accuracy=0.4114583333333333\n",
      "8100 loss=1.5974575404063196 accuracy=0.3958333333333333\n",
      "8200 loss=1.585480718293849 accuracy=0.390625\n",
      "8300 loss=1.5955643600576241 accuracy=0.3958333333333333\n",
      "8400 loss=1.5899914182706603 accuracy=0.390625\n",
      "8500 loss=1.5962341388527364 accuracy=0.3958333333333333\n",
      "8600 loss=1.5959191327852604 accuracy=0.4010416666666667\n",
      "8700 loss=1.5849904717447771 accuracy=0.421875\n",
      "8800 loss=1.5732910378508507 accuracy=0.40625\n",
      "8900 loss=1.5928545982287408 accuracy=0.375\n",
      "9000 loss=1.5809482521115445 accuracy=0.4192708333333333\n",
      "9100 loss=1.5826908338960668 accuracy=0.4114583333333333\n",
      "9200 loss=1.586084679993473 accuracy=0.3958333333333333\n",
      "9300 loss=1.5815397530463833 accuracy=0.3723958333333333\n",
      "9400 loss=1.593267296121288 accuracy=0.3541666666666667\n",
      "9500 loss=1.580442272047561 accuracy=0.3958333333333333\n",
      "9600 loss=1.5716587174195427 accuracy=0.4010416666666667\n",
      "9700 loss=1.5712966659390775 accuracy=0.4088541666666667\n",
      "9800 loss=1.5588426607916719 accuracy=0.4375\n",
      "9900 loss=1.5809796471678272 accuracy=0.40625\n",
      "10000 loss=1.5696197497666982 accuracy=0.4036458333333333\n",
      "10100 loss=1.5658187589546193 accuracy=0.4140625\n",
      "10200 loss=1.5647297752926488 accuracy=0.4244791666666667\n",
      "10300 loss=1.590132384085646 accuracy=0.3958333333333333\n",
      "10400 loss=1.565150221646124 accuracy=0.4140625\n",
      "10500 loss=1.5487733210654178 accuracy=0.3958333333333333\n",
      "10600 loss=1.545038327170122 accuracy=0.4375\n",
      "10700 loss=1.5346408464559815 accuracy=0.4010416666666667\n",
      "10800 loss=1.5274019620108412 accuracy=0.4296875\n",
      "10900 loss=1.5185683020672163 accuracy=0.4453125\n",
      "11000 loss=1.5060040831268655 accuracy=0.4427083333333333\n",
      "11100 loss=1.5231080745601426 accuracy=0.421875\n",
      "11200 loss=1.5002035117414363 accuracy=0.40625\n",
      "11300 loss=1.493045634836493 accuracy=0.4296875\n",
      "11400 loss=1.5002759866073014 accuracy=0.4322916666666667\n",
      "11500 loss=1.4827958127306398 accuracy=0.4296875\n",
      "11600 loss=1.4621179673329157 accuracy=0.4739583333333333\n",
      "11700 loss=1.4821177807788248 accuracy=0.4557291666666667\n",
      "11800 loss=1.449510018901636 accuracy=0.4713541666666667\n",
      "11900 loss=1.4311815966335353 accuracy=0.4557291666666667\n",
      "12000 loss=1.4229950422469007 accuracy=0.4322916666666667\n",
      "12100 loss=1.4008220455931188 accuracy=0.4947916666666667\n",
      "12200 loss=1.417887884807918 accuracy=0.4557291666666667\n",
      "12300 loss=1.4163883245804771 accuracy=0.4817708333333333\n",
      "12400 loss=1.4399412659767123 accuracy=0.4609375\n",
      "12500 loss=1.4161882047009495 accuracy=0.4609375\n",
      "12600 loss=1.4097142629067587 accuracy=0.46875\n",
      "12700 loss=1.4056919936824892 accuracy=0.4765625\n",
      "12800 loss=1.3887182502196707 accuracy=0.4739583333333333\n",
      "12900 loss=1.361214240989707 accuracy=0.5104166666666666\n",
      "13000 loss=1.3910550077271258 accuracy=0.4739583333333333\n",
      "13100 loss=1.3727517201542243 accuracy=0.4921875\n",
      "13200 loss=1.334998513455004 accuracy=0.5052083333333334\n",
      "13300 loss=1.369998041619261 accuracy=0.4921875\n",
      "13400 loss=1.3515232411815212 accuracy=0.4973958333333333\n",
      "13500 loss=1.3526457237939074 accuracy=0.4817708333333333\n",
      "13600 loss=1.3699284746433809 accuracy=0.4869791666666667\n",
      "13700 loss=1.3737689494258367 accuracy=0.4869791666666667\n",
      "13800 loss=1.3745300782085135 accuracy=0.5\n",
      "13900 loss=1.3383953218436755 accuracy=0.5078125\n",
      "14000 loss=1.3389981987197488 accuracy=0.4895833333333333\n",
      "14100 loss=1.321469874341469 accuracy=0.4973958333333333\n",
      "14200 loss=1.33371242562591 accuracy=0.5260416666666666\n",
      "14300 loss=1.309761682429937 accuracy=0.5208333333333334\n",
      "14400 loss=1.3165683998223079 accuracy=0.5078125\n",
      "14500 loss=1.3414071274615353 accuracy=0.5026041666666666\n",
      "14600 loss=1.3567024559692933 accuracy=0.4947916666666667\n",
      "14700 loss=1.3564462578408634 accuracy=0.4791666666666667\n",
      "14800 loss=1.3177544103877397 accuracy=0.5208333333333334\n",
      "14900 loss=1.3290853374092229 accuracy=0.5026041666666666\n",
      "15000 loss=1.3124379483248183 accuracy=0.4895833333333333\n",
      "15100 loss=1.328897759115574 accuracy=0.5182291666666666\n",
      "15200 loss=1.315047086696752 accuracy=0.515625\n",
      "15300 loss=1.2762742377004934 accuracy=0.5364583333333334\n",
      "15400 loss=1.3178556811415594 accuracy=0.5182291666666666\n",
      "15500 loss=1.3201876311685128 accuracy=0.5416666666666666\n",
      "15600 loss=1.2911390557951583 accuracy=0.515625\n",
      "15700 loss=1.2945350342195159 accuracy=0.5078125\n",
      "15800 loss=1.3004626075511472 accuracy=0.53125\n",
      "15900 loss=1.2883603199068365 accuracy=0.515625\n",
      "16000 loss=1.320634892117012 accuracy=0.4973958333333333\n",
      "16100 loss=1.3011337283748006 accuracy=0.515625\n",
      "16200 loss=1.2774983137192804 accuracy=0.5182291666666666\n",
      "16300 loss=1.2818516919278027 accuracy=0.5416666666666666\n",
      "16400 loss=1.2921799474905618 accuracy=0.5234375\n",
      "16500 loss=1.2947001000507747 accuracy=0.5052083333333334\n",
      "16600 loss=1.2859318685831043 accuracy=0.5052083333333334\n",
      "16700 loss=1.2953414898774147 accuracy=0.5286458333333334\n",
      "16800 loss=1.2904529964303502 accuracy=0.5260416666666666\n",
      "16900 loss=1.282738494885061 accuracy=0.5520833333333334\n",
      "17000 loss=1.2790869762154928 accuracy=0.53125\n",
      "17100 loss=1.2759403440602832 accuracy=0.5390625\n",
      "17200 loss=1.2735144506504614 accuracy=0.5338541666666666\n",
      "17300 loss=1.2573692236533092 accuracy=0.5364583333333334\n",
      "17400 loss=1.2604565412394642 accuracy=0.5234375\n",
      "17500 loss=1.2707715174392988 accuracy=0.5338541666666666\n",
      "17600 loss=1.2675893655897648 accuracy=0.5130208333333334\n",
      "17700 loss=1.2999032667463422 accuracy=0.5182291666666666\n",
      "17800 loss=1.287133836823311 accuracy=0.5260416666666666\n",
      "17900 loss=1.2732371892737913 accuracy=0.53125\n",
      "18000 loss=1.2772299332159924 accuracy=0.53125\n",
      "18100 loss=1.2547612560912549 accuracy=0.53125\n",
      "18200 loss=1.263288907750102 accuracy=0.5234375\n",
      "18300 loss=1.2659586210666598 accuracy=0.5338541666666666\n",
      "18400 loss=1.272349946853032 accuracy=0.5130208333333334\n",
      "18500 loss=1.2907334394897434 accuracy=0.5182291666666666\n",
      "18600 loss=1.286267841720344 accuracy=0.53125\n",
      "18700 loss=1.2564352142818351 accuracy=0.5364583333333334\n",
      "18800 loss=1.2315989837604562 accuracy=0.546875\n",
      "18900 loss=1.2602643082684921 accuracy=0.5286458333333334\n",
      "19000 loss=1.260007134173376 accuracy=0.5364583333333334\n",
      "19100 loss=1.2535622405195224 accuracy=0.5286458333333334\n",
      "19200 loss=1.251448983601279 accuracy=0.5572916666666666\n",
      "19300 loss=1.2304660754543768 accuracy=0.5755208333333334\n",
      "19400 loss=1.2377876863622297 accuracy=0.515625\n",
      "19500 loss=1.2476647653417992 accuracy=0.5416666666666666\n",
      "19600 loss=1.2399321053422885 accuracy=0.5390625\n",
      "19700 loss=1.241242977032905 accuracy=0.5442708333333334\n",
      "19800 loss=1.2849742296061308 accuracy=0.5338541666666666\n",
      "19900 loss=1.2658275615832697 accuracy=0.5260416666666666\n",
      "20000 loss=1.2540581675213018 accuracy=0.5416666666666666\n",
      "20100 loss=1.2469254287948903 accuracy=0.5182291666666666\n",
      "20200 loss=1.2525355238455742 accuracy=0.5390625\n",
      "20300 loss=1.2479057697181628 accuracy=0.5364583333333334\n",
      "20400 loss=1.2399645071086722 accuracy=0.546875\n",
      "20500 loss=1.2587570570754347 accuracy=0.5338541666666666\n",
      "20600 loss=1.256747687152291 accuracy=0.5260416666666666\n",
      "20700 loss=1.236006393346504 accuracy=0.5182291666666666\n",
      "20800 loss=1.234444763398938 accuracy=0.5364583333333334\n",
      "20900 loss=1.2468785369585098 accuracy=0.5416666666666666\n",
      "21000 loss=1.233454691660505 accuracy=0.5520833333333334\n",
      "21100 loss=1.2163767791116344 accuracy=0.5546875\n",
      "21200 loss=1.2341612287828196 accuracy=0.5520833333333334\n",
      "21300 loss=1.240321401344399 accuracy=0.5625\n",
      "21400 loss=1.2428707530665957 accuracy=0.5364583333333334\n",
      "21500 loss=1.2501400249740062 accuracy=0.546875\n",
      "21600 loss=1.2580485727790123 accuracy=0.546875\n",
      "21700 loss=1.232294875832655 accuracy=0.5625\n",
      "21800 loss=1.2613949127609996 accuracy=0.5260416666666666\n",
      "21900 loss=1.236142691649063 accuracy=0.5520833333333334\n",
      "22000 loss=1.22798643501473 accuracy=0.5390625\n",
      "22100 loss=1.2252331092662208 accuracy=0.5494791666666666\n",
      "22200 loss=1.2361319262624613 accuracy=0.5625\n",
      "22300 loss=1.23825141278314 accuracy=0.5598958333333334\n",
      "22400 loss=1.2303093989366096 accuracy=0.5390625\n",
      "22500 loss=1.247965016430645 accuracy=0.5546875\n",
      "22600 loss=1.2482037505336738 accuracy=0.5338541666666666\n",
      "22700 loss=1.247825955126212 accuracy=0.5338541666666666\n",
      "22800 loss=1.2268857920197873 accuracy=0.5364583333333334\n",
      "22900 loss=1.2258485193404214 accuracy=0.5442708333333334\n",
      "23000 loss=1.2452010778712275 accuracy=0.5390625\n",
      "23100 loss=1.228677945194676 accuracy=0.5364583333333334\n",
      "23200 loss=1.2430589140969073 accuracy=0.5442708333333334\n",
      "23300 loss=1.217917580845848 accuracy=0.5598958333333334\n",
      "23400 loss=1.2414547494759554 accuracy=0.5390625\n",
      "23500 loss=1.2260652977190922 accuracy=0.5130208333333334\n",
      "23600 loss=1.2207797264686682 accuracy=0.5677083333333334\n",
      "23700 loss=1.2237792244288 accuracy=0.5625\n",
      "23800 loss=1.231339405103836 accuracy=0.53125\n",
      "23900 loss=1.2259439081112906 accuracy=0.5494791666666666\n",
      "24000 loss=1.2355191236696237 accuracy=0.5546875\n",
      "24100 loss=1.2322343191943297 accuracy=0.5520833333333334\n",
      "24200 loss=1.2517830002640653 accuracy=0.5234375\n",
      "24300 loss=1.2107122831727817 accuracy=0.5703125\n",
      "24400 loss=1.2144224163961703 accuracy=0.5546875\n",
      "24500 loss=1.2238528744297286 accuracy=0.5390625\n",
      "24600 loss=1.2260797386690667 accuracy=0.5416666666666666\n",
      "24700 loss=1.2226939493112898 accuracy=0.5442708333333334\n",
      "24800 loss=1.2248032421465687 accuracy=0.5416666666666666\n",
      "24900 loss=1.2298471054709696 accuracy=0.5364583333333334\n",
      "25000 loss=1.2313385502542753 accuracy=0.5364583333333334\n",
      "25100 loss=1.2332296491494437 accuracy=0.5260416666666666\n",
      "25200 loss=1.2361261524316185 accuracy=0.5546875\n",
      "25300 loss=1.2358482860925277 accuracy=0.5442708333333334\n",
      "25400 loss=1.2279376571478973 accuracy=0.5442708333333334\n",
      "25500 loss=1.248334300604918 accuracy=0.5286458333333334\n",
      "25600 loss=1.2216128563004083 accuracy=0.546875\n",
      "25700 loss=1.2262309673718117 accuracy=0.5364583333333334\n",
      "25800 loss=1.2184452942842023 accuracy=0.5546875\n",
      "25900 loss=1.19260507479742 accuracy=0.5520833333333334\n",
      "26000 loss=1.223482825837961 accuracy=0.5364583333333334\n",
      "26100 loss=1.2331070082772722 accuracy=0.53125\n",
      "26200 loss=1.2349241444078247 accuracy=0.5364583333333334\n",
      "26300 loss=1.2244355385793817 accuracy=0.53125\n",
      "26400 loss=1.2191380711713835 accuracy=0.5442708333333334\n",
      "26500 loss=1.243169682868044 accuracy=0.5286458333333334\n",
      "26600 loss=1.2282533625263778 accuracy=0.546875\n",
      "26700 loss=1.2335681353108765 accuracy=0.5234375\n",
      "26800 loss=1.208922697436558 accuracy=0.53125\n",
      "26900 loss=1.2159146265909355 accuracy=0.5598958333333334\n",
      "27000 loss=1.21276457634525 accuracy=0.5546875\n",
      "27100 loss=1.2229177057079603 accuracy=0.5416666666666666\n",
      "27200 loss=1.2194223499208217 accuracy=0.5442708333333334\n",
      "27300 loss=1.2049785441590093 accuracy=0.5442708333333334\n",
      "27400 loss=1.2533667736334833 accuracy=0.5208333333333334\n",
      "27500 loss=1.2057975635692393 accuracy=0.5494791666666666\n",
      "27600 loss=1.2307218765746744 accuracy=0.5572916666666666\n",
      "27700 loss=1.2086606756253953 accuracy=0.5729166666666666\n",
      "27800 loss=1.2026748286949975 accuracy=0.5598958333333334\n",
      "27900 loss=1.25100058863684 accuracy=0.5390625\n",
      "28000 loss=1.2072688602112107 accuracy=0.5546875\n",
      "28100 loss=1.2433835701989573 accuracy=0.5338541666666666\n",
      "28200 loss=1.2221704132119333 accuracy=0.5208333333333334\n",
      "28300 loss=1.1982732589632472 accuracy=0.5520833333333334\n",
      "28400 loss=1.217736415228705 accuracy=0.5390625\n",
      "28500 loss=1.2053537525063858 accuracy=0.5416666666666666\n",
      "28600 loss=1.1990964287711994 accuracy=0.5520833333333334\n",
      "28700 loss=1.2001775733686817 accuracy=0.5703125\n",
      "28800 loss=1.2138346976775323 accuracy=0.5390625\n",
      "28900 loss=1.230924244204994 accuracy=0.5390625\n",
      "29000 loss=1.2059402293618924 accuracy=0.5442708333333334\n",
      "29100 loss=1.2237799928004889 accuracy=0.5390625\n",
      "29200 loss=1.232912855747994 accuracy=0.5338541666666666\n",
      "29300 loss=1.2122993018988004 accuracy=0.5442708333333334\n",
      "29400 loss=1.2082175383088725 accuracy=0.5416666666666666\n",
      "29500 loss=1.1935022681477785 accuracy=0.5598958333333334\n",
      "29600 loss=1.2014635841126013 accuracy=0.5651041666666666\n",
      "29700 loss=1.2088747016063854 accuracy=0.5520833333333334\n",
      "29800 loss=1.2187197469837276 accuracy=0.5234375\n",
      "29900 loss=1.2156462143323883 accuracy=0.5286458333333334\n",
      "30000 loss=1.1927409164927365 accuracy=0.5598958333333334\n",
      "30100 loss=1.2150994950727936 accuracy=0.53125\n",
      "30200 loss=1.218657681006598 accuracy=0.5364583333333334\n",
      "30300 loss=1.2247748527085247 accuracy=0.5390625\n",
      "30400 loss=1.211529264869776 accuracy=0.5546875\n",
      "30500 loss=1.2115244873247015 accuracy=0.5364583333333334\n",
      "30600 loss=1.2069358920224595 accuracy=0.5625\n",
      "30700 loss=1.192720597051915 accuracy=0.5520833333333334\n",
      "30800 loss=1.1966200363261803 accuracy=0.546875\n",
      "30900 loss=1.1980468745270958 accuracy=0.5598958333333334\n",
      "31000 loss=1.2052351112177835 accuracy=0.5416666666666666\n",
      "31100 loss=1.190516974472762 accuracy=0.5625\n",
      "31200 loss=1.2044697561041595 accuracy=0.5494791666666666\n",
      "31300 loss=1.24223611133999 accuracy=0.5494791666666666\n",
      "31400 loss=1.1921410673734432 accuracy=0.5729166666666666\n",
      "31500 loss=1.2212775857179228 accuracy=0.5364583333333334\n",
      "31600 loss=1.210060572554525 accuracy=0.5442708333333334\n",
      "31700 loss=1.1995553311662213 accuracy=0.5520833333333334\n",
      "31800 loss=1.1964106391413352 accuracy=0.5677083333333334\n",
      "31900 loss=1.1865316067770362 accuracy=0.5572916666666666\n",
      "32000 loss=1.1935732810038293 accuracy=0.5651041666666666\n",
      "32100 loss=1.1916535294892872 accuracy=0.5546875\n",
      "32200 loss=1.2052555883129177 accuracy=0.5442708333333334\n",
      "32300 loss=1.1976355629000741 accuracy=0.5807291666666666\n",
      "32400 loss=1.1901754284747637 accuracy=0.5520833333333334\n",
      "32500 loss=1.2066998316297204 accuracy=0.5546875\n",
      "32600 loss=1.201634032567942 accuracy=0.5494791666666666\n",
      "32700 loss=1.1936311040339103 accuracy=0.5651041666666666\n",
      "32800 loss=1.2070589137014285 accuracy=0.5677083333333334\n",
      "32900 loss=1.1767124045265496 accuracy=0.5338541666666666\n",
      "33000 loss=1.1778103804621631 accuracy=0.546875\n",
      "33100 loss=1.2128601196205648 accuracy=0.5677083333333334\n",
      "33200 loss=1.1683081719144117 accuracy=0.5651041666666666\n",
      "33300 loss=1.1601931801364194 accuracy=0.5651041666666666\n",
      "33400 loss=1.1927008911680326 accuracy=0.5494791666666666\n",
      "33500 loss=1.180693300889879 accuracy=0.5546875\n",
      "33600 loss=1.1916744792548761 accuracy=0.5651041666666666\n",
      "33700 loss=1.1574066807020724 accuracy=0.5651041666666666\n",
      "33800 loss=1.1681458743608548 accuracy=0.5677083333333334\n",
      "33900 loss=1.1697844840484946 accuracy=0.5572916666666666\n",
      "34000 loss=1.1713832098696528 accuracy=0.5625\n",
      "34100 loss=1.1899556977404369 accuracy=0.5598958333333334\n",
      "34200 loss=1.1575480292455786 accuracy=0.5494791666666666\n",
      "34300 loss=1.1409321296544146 accuracy=0.5572916666666666\n",
      "34400 loss=1.1314625626738253 accuracy=0.5755208333333334\n",
      "34500 loss=1.1024736232490284 accuracy=0.59375\n",
      "34600 loss=1.1146816740456422 accuracy=0.6041666666666666\n",
      "34700 loss=1.1314154366060933 accuracy=0.5729166666666666\n",
      "34800 loss=1.1076917633907462 accuracy=0.59375\n",
      "34900 loss=1.1255621620096892 accuracy=0.5703125\n",
      "35000 loss=1.087271192914054 accuracy=0.5911458333333334\n",
      "35100 loss=1.1144896919795988 accuracy=0.609375\n",
      "35200 loss=1.0763978436327553 accuracy=0.6197916666666666\n",
      "35300 loss=1.083842867807442 accuracy=0.5989583333333334\n",
      "35400 loss=1.0250716590991664 accuracy=0.6536458333333334\n",
      "35500 loss=1.0062163330591853 accuracy=0.6171875\n",
      "35600 loss=1.0611351576979593 accuracy=0.6067708333333334\n",
      "35700 loss=1.0428859483332253 accuracy=0.6302083333333334\n",
      "35800 loss=0.9955435981991819 accuracy=0.6458333333333334\n",
      "35900 loss=0.9947962146275617 accuracy=0.625\n",
      "36000 loss=1.032373286897757 accuracy=0.6276041666666666\n",
      "36100 loss=0.9519375934573109 accuracy=0.6484375\n",
      "36200 loss=0.9818920027561335 accuracy=0.6484375\n",
      "36300 loss=0.9947024975191906 accuracy=0.6302083333333334\n",
      "36400 loss=0.9787974399012915 accuracy=0.6145833333333334\n",
      "36500 loss=0.9468294345137427 accuracy=0.6666666666666666\n",
      "36600 loss=0.9556990390449469 accuracy=0.6614583333333334\n",
      "36700 loss=0.9711143962342309 accuracy=0.6380208333333334\n",
      "36800 loss=0.9168642373788958 accuracy=0.6640625\n",
      "36900 loss=0.9610507123513159 accuracy=0.6588541666666666\n",
      "37000 loss=0.9312756954371799 accuracy=0.6640625\n",
      "37100 loss=0.8889673782694439 accuracy=0.6979166666666666\n",
      "37200 loss=0.905371416090708 accuracy=0.6848958333333334\n",
      "37300 loss=0.9209398490705781 accuracy=0.6979166666666666\n",
      "37400 loss=0.9126127283027842 accuracy=0.6848958333333334\n",
      "37500 loss=0.8649784859015034 accuracy=0.6979166666666666\n",
      "37600 loss=0.8407479708538002 accuracy=0.71875\n",
      "37700 loss=0.8330608510566495 accuracy=0.7317708333333334\n",
      "37800 loss=0.8159195775268187 accuracy=0.6979166666666666\n",
      "37900 loss=0.8074851825805809 accuracy=0.7135416666666666\n",
      "38000 loss=0.7629126430370141 accuracy=0.7604166666666666\n",
      "38100 loss=0.7566808236288548 accuracy=0.7369791666666666\n",
      "38200 loss=0.7037148729538965 accuracy=0.7760416666666666\n",
      "38300 loss=0.6970023543271244 accuracy=0.7578125\n",
      "38400 loss=0.6494604147834103 accuracy=0.796875\n",
      "38500 loss=0.6338906728185376 accuracy=0.8098958333333334\n",
      "38600 loss=0.6514960320139219 accuracy=0.7890625\n",
      "38700 loss=0.6277755703043062 accuracy=0.8098958333333334\n",
      "38800 loss=0.5632090617468977 accuracy=0.8203125\n",
      "38900 loss=0.5734753082157411 accuracy=0.8255208333333334\n",
      "39000 loss=0.560067919231234 accuracy=0.828125\n",
      "39100 loss=0.5522061388144976 accuracy=0.8203125\n",
      "39200 loss=0.5442159436365848 accuracy=0.8072916666666666\n",
      "39300 loss=0.5894068900871621 accuracy=0.78125\n",
      "39400 loss=0.5368615978964311 accuracy=0.828125\n",
      "39500 loss=0.5247349236828442 accuracy=0.8151041666666666\n",
      "39600 loss=0.49197514759173805 accuracy=0.8411458333333334\n",
      "39700 loss=0.536840717703688 accuracy=0.8098958333333334\n",
      "39800 loss=0.5019423480038687 accuracy=0.8072916666666666\n",
      "39900 loss=0.46883905931292774 accuracy=0.8411458333333334\n",
      "40000 loss=0.4571195607340062 accuracy=0.8411458333333334\n",
      "40100 loss=0.45496748154171107 accuracy=0.8463541666666666\n",
      "40200 loss=0.45310644804668093 accuracy=0.8541666666666666\n",
      "40300 loss=0.42443371095299054 accuracy=0.8463541666666666\n",
      "40400 loss=0.39919889516788404 accuracy=0.8307291666666666\n",
      "40500 loss=0.3684022694308114 accuracy=0.8567708333333334\n",
      "40600 loss=0.37544432906446756 accuracy=0.8619791666666666\n",
      "40700 loss=0.3519250330963014 accuracy=0.8697916666666666\n",
      "40800 loss=0.3328642838367416 accuracy=0.875\n",
      "40900 loss=0.2932721390553128 accuracy=0.8854166666666666\n",
      "41000 loss=0.30925142261474964 accuracy=0.8567708333333334\n",
      "41100 loss=0.2422964894324017 accuracy=0.8984375\n",
      "41200 loss=0.26099217690227516 accuracy=0.890625\n",
      "41300 loss=0.2517706749578689 accuracy=0.890625\n",
      "41400 loss=0.25259212190313646 accuracy=0.8828125\n",
      "41500 loss=0.23292350310820079 accuracy=0.8854166666666666\n",
      "41600 loss=0.230043840460451 accuracy=0.90625\n",
      "41700 loss=0.23155938232035625 accuracy=0.8984375\n",
      "41800 loss=0.21376481333136993 accuracy=0.9166666666666666\n",
      "41900 loss=0.23458471511596862 accuracy=0.8854166666666666\n",
      "42000 loss=0.20316279883739974 accuracy=0.9114583333333334\n",
      "42100 loss=0.22498514365761238 accuracy=0.8880208333333334\n",
      "42200 loss=0.2287057029830346 accuracy=0.8802083333333334\n",
      "42300 loss=0.21925805798194287 accuracy=0.8854166666666666\n",
      "42400 loss=0.22567362400216762 accuracy=0.8828125\n",
      "42500 loss=0.2117732351992725 accuracy=0.8984375\n",
      "42600 loss=0.19864279017829167 accuracy=0.9140625\n",
      "42700 loss=0.21310155815442422 accuracy=0.90625\n",
      "42800 loss=0.20570589164985542 accuracy=0.9010416666666666\n",
      "42900 loss=0.22322446956364345 accuracy=0.890625\n",
      "43000 loss=0.21432315302555083 accuracy=0.890625\n",
      "43100 loss=0.19225642504339202 accuracy=0.9192708333333334\n",
      "43200 loss=0.20265551940202445 accuracy=0.8932291666666666\n",
      "43300 loss=0.20512454618796483 accuracy=0.9010416666666666\n",
      "43400 loss=0.17965482795820356 accuracy=0.9192708333333334\n",
      "43500 loss=0.19671529899595455 accuracy=0.8984375\n",
      "43600 loss=0.18709342493759185 accuracy=0.9166666666666666\n",
      "43700 loss=0.19925880351031805 accuracy=0.9166666666666666\n",
      "43800 loss=0.2001333945716824 accuracy=0.8984375\n",
      "43900 loss=0.22218524987110025 accuracy=0.8619791666666666\n",
      "44000 loss=0.20450583251383186 accuracy=0.9244791666666666\n",
      "44100 loss=0.17906952612417917 accuracy=0.9296875\n",
      "44200 loss=0.20098952849968857 accuracy=0.9114583333333334\n",
      "44300 loss=0.1772494533398278 accuracy=0.9375\n",
      "44400 loss=0.17781650397711274 accuracy=0.9296875\n",
      "44500 loss=0.17278076305762594 accuracy=0.9270833333333334\n",
      "44600 loss=0.18138926042948283 accuracy=0.9244791666666666\n",
      "44700 loss=0.1459995348171357 accuracy=0.953125\n",
      "44800 loss=0.16493327828860657 accuracy=0.9479166666666666\n",
      "44900 loss=0.1693220528038205 accuracy=0.9348958333333334\n",
      "45000 loss=0.1412552291252644 accuracy=0.9557291666666666\n",
      "45100 loss=0.15167616505833936 accuracy=0.9427083333333334\n",
      "45200 loss=0.13584886507481575 accuracy=0.953125\n",
      "45300 loss=0.15953373286359412 accuracy=0.9453125\n",
      "45400 loss=0.15593853198011362 accuracy=0.9453125\n",
      "45500 loss=0.1547867418103504 accuracy=0.9322916666666666\n",
      "45600 loss=0.18612284826491043 accuracy=0.921875\n",
      "45700 loss=0.12679897605754592 accuracy=0.9583333333333334\n",
      "45800 loss=0.14778680264871896 accuracy=0.9557291666666666\n",
      "45900 loss=0.14680666351441 accuracy=0.9505208333333334\n",
      "46000 loss=0.13113485596435862 accuracy=0.9479166666666666\n",
      "46100 loss=0.12310914095349719 accuracy=0.9661458333333334\n",
      "46200 loss=0.15087214908289354 accuracy=0.9427083333333334\n",
      "46300 loss=0.13572629588234708 accuracy=0.9609375\n",
      "46400 loss=0.13519697576294765 accuracy=0.953125\n",
      "46500 loss=0.13842304975921488 accuracy=0.9401041666666666\n",
      "46600 loss=0.16350672679830114 accuracy=0.9401041666666666\n",
      "46700 loss=0.12347756877660294 accuracy=0.953125\n",
      "46800 loss=0.13047461705207533 accuracy=0.9479166666666666\n",
      "46900 loss=0.13148644361141928 accuracy=0.953125\n",
      "47000 loss=0.1260861207744131 accuracy=0.9583333333333334\n",
      "47100 loss=0.13295350940409545 accuracy=0.9583333333333334\n",
      "47200 loss=0.11593005632030214 accuracy=0.9583333333333334\n",
      "47300 loss=0.11136502122871397 accuracy=0.9609375\n",
      "47400 loss=0.1284217867040103 accuracy=0.9609375\n",
      "47500 loss=0.10348805532929811 accuracy=0.9739583333333334\n",
      "47600 loss=0.11762474447638406 accuracy=0.9661458333333334\n",
      "47700 loss=0.11646526980806282 accuracy=0.96875\n",
      "47800 loss=0.13017918772201414 accuracy=0.9427083333333334\n",
      "47900 loss=0.12877738706873365 accuracy=0.953125\n",
      "48000 loss=0.11420430451761228 accuracy=0.9609375\n",
      "48100 loss=0.1097457076891893 accuracy=0.9661458333333334\n",
      "48200 loss=0.10908301690374003 accuracy=0.9713541666666666\n",
      "48300 loss=0.10353461838701306 accuracy=0.9661458333333334\n",
      "48400 loss=0.1107253043994201 accuracy=0.9635416666666666\n",
      "48500 loss=0.1034948318606549 accuracy=0.9765625\n",
      "48600 loss=0.11430074728111236 accuracy=0.9635416666666666\n",
      "48700 loss=0.11137115865551908 accuracy=0.9583333333333334\n",
      "48800 loss=0.11682572638933726 accuracy=0.9583333333333334\n",
      "48900 loss=0.08839242131658112 accuracy=0.9713541666666666\n",
      "49000 loss=0.09791968416575267 accuracy=0.9661458333333334\n",
      "49100 loss=0.128339256020526 accuracy=0.953125\n",
      "49200 loss=0.11021821440314505 accuracy=0.9609375\n",
      "49300 loss=0.11259434247299108 accuracy=0.9609375\n",
      "49400 loss=0.128779039864224 accuracy=0.953125\n",
      "49500 loss=0.11778649821981413 accuracy=0.96875\n",
      "49600 loss=0.0962397123818702 accuracy=0.9791666666666666\n",
      "49700 loss=0.10532714467260118 accuracy=0.96875\n",
      "49800 loss=0.11299128039342277 accuracy=0.9609375\n",
      "49900 loss=0.10907823156017145 accuracy=0.9713541666666666\n",
      "50000 loss=0.10057574365934421 accuracy=0.96875\n",
      "50100 loss=0.0869612135600463 accuracy=0.9869791666666666\n",
      "50200 loss=0.11614189327672633 accuracy=0.9661458333333334\n",
      "50300 loss=0.09817617689210925 accuracy=0.9713541666666666\n",
      "50400 loss=0.10463931416796579 accuracy=0.9557291666666666\n",
      "50500 loss=0.11327040084045371 accuracy=0.96875\n",
      "50600 loss=0.10998347581368717 accuracy=0.9817708333333334\n",
      "50700 loss=0.10468274366001575 accuracy=0.9713541666666666\n",
      "50800 loss=0.10032412116269218 accuracy=0.96875\n",
      "50900 loss=0.09989962382329277 accuracy=0.9609375\n",
      "51000 loss=0.10491911532267863 accuracy=0.9713541666666666\n",
      "51100 loss=0.09632400856559203 accuracy=0.9739583333333334\n",
      "51200 loss=0.10212145858852813 accuracy=0.96875\n",
      "51300 loss=0.1057750679290213 accuracy=0.96875\n",
      "51400 loss=0.11008791875551245 accuracy=0.9583333333333334\n",
      "51500 loss=0.09828621431786314 accuracy=0.9661458333333334\n",
      "51600 loss=0.12786367598203383 accuracy=0.953125\n",
      "51700 loss=0.08110201454895782 accuracy=0.9895833333333334\n",
      "51800 loss=0.10665893003233712 accuracy=0.953125\n",
      "51900 loss=0.0790321258658705 accuracy=0.9765625\n",
      "52000 loss=0.10914370811716259 accuracy=0.9661458333333334\n",
      "52100 loss=0.11758637842109876 accuracy=0.9505208333333334\n",
      "52200 loss=0.09989021484948886 accuracy=0.9557291666666666\n",
      "52300 loss=0.09588908551054612 accuracy=0.9635416666666666\n",
      "52400 loss=0.11406569629116534 accuracy=0.9505208333333334\n",
      "52500 loss=0.09149677968781536 accuracy=0.9739583333333334\n",
      "52600 loss=0.11671434538128557 accuracy=0.9609375\n",
      "52700 loss=0.09669735232158194 accuracy=0.9609375\n",
      "52800 loss=0.1062243575407813 accuracy=0.9557291666666666\n",
      "52900 loss=0.09339600340805768 accuracy=0.96875\n",
      "53000 loss=0.10786776959986555 accuracy=0.9583333333333334\n",
      "53100 loss=0.07683165903055977 accuracy=0.984375\n",
      "53200 loss=0.09458540848953187 accuracy=0.9739583333333334\n",
      "53300 loss=0.10002677706832215 accuracy=0.9765625\n",
      "53400 loss=0.10681786531413302 accuracy=0.9609375\n",
      "53500 loss=0.0973805122000013 accuracy=0.96875\n",
      "53600 loss=0.08543289401858309 accuracy=0.9791666666666666\n",
      "53700 loss=0.08483430311614329 accuracy=0.9765625\n",
      "53800 loss=0.09983278183863664 accuracy=0.9635416666666666\n",
      "53900 loss=0.09606474139385804 accuracy=0.9557291666666666\n",
      "54000 loss=0.0968395773779952 accuracy=0.9765625\n",
      "54100 loss=0.07307798930179543 accuracy=0.984375\n",
      "54200 loss=0.08608262085333936 accuracy=0.9791666666666666\n",
      "54300 loss=0.1099829209371589 accuracy=0.9583333333333334\n",
      "54400 loss=0.09275199211913357 accuracy=0.9661458333333334\n",
      "54500 loss=0.0872652315134359 accuracy=0.9791666666666666\n",
      "54600 loss=0.1022778612535844 accuracy=0.96875\n",
      "54700 loss=0.08172401192282815 accuracy=0.9765625\n",
      "54800 loss=0.08648254489723739 accuracy=0.9739583333333334\n",
      "54900 loss=0.09825584147037537 accuracy=0.9635416666666666\n",
      "55000 loss=0.08544883672121097 accuracy=0.9791666666666666\n",
      "55100 loss=0.09429674452094369 accuracy=0.9635416666666666\n",
      "55200 loss=0.0839184484443311 accuracy=0.9791666666666666\n",
      "55300 loss=0.09388109541465076 accuracy=0.9635416666666666\n",
      "55400 loss=0.08936614737692829 accuracy=0.9739583333333334\n",
      "55500 loss=0.08338714828823997 accuracy=0.9869791666666666\n",
      "55600 loss=0.080174330386933 accuracy=0.984375\n",
      "55700 loss=0.08644046445124318 accuracy=0.9661458333333334\n",
      "55800 loss=0.09769672217549674 accuracy=0.9609375\n",
      "55900 loss=0.1002940298133958 accuracy=0.9505208333333334\n",
      "56000 loss=0.09289246861184433 accuracy=0.9661458333333334\n",
      "56100 loss=0.07016857281268718 accuracy=0.9817708333333334\n",
      "56200 loss=0.08900794296381656 accuracy=0.9609375\n",
      "56300 loss=0.0835022939157456 accuracy=0.9869791666666666\n",
      "56400 loss=0.07745471482481273 accuracy=0.9791666666666666\n",
      "56500 loss=0.07936973177312118 accuracy=0.9739583333333334\n",
      "56600 loss=0.08119249787196105 accuracy=0.9869791666666666\n",
      "56700 loss=0.08744440985427704 accuracy=0.9635416666666666\n",
      "56800 loss=0.08755157641915826 accuracy=0.9713541666666666\n",
      "56900 loss=0.10172112551060104 accuracy=0.96875\n",
      "57000 loss=0.1098865086776527 accuracy=0.9661458333333334\n",
      "57100 loss=0.09122594815039675 accuracy=0.9817708333333334\n",
      "57200 loss=0.08017844714875773 accuracy=0.9817708333333334\n",
      "57300 loss=0.08009158660497606 accuracy=0.9869791666666666\n",
      "57400 loss=0.0964638915783846 accuracy=0.9661458333333334\n",
      "57500 loss=0.08835697611513837 accuracy=0.9661458333333334\n",
      "57600 loss=0.07323364433464563 accuracy=0.984375\n",
      "57700 loss=0.07387515271525893 accuracy=0.9817708333333334\n",
      "57800 loss=0.07409300539147781 accuracy=0.984375\n",
      "57900 loss=0.07712357547134313 accuracy=0.9817708333333334\n",
      "58000 loss=0.0825559373687259 accuracy=0.9791666666666666\n",
      "58100 loss=0.08961764114182189 accuracy=0.9661458333333334\n",
      "58200 loss=0.07372965147192323 accuracy=0.9791666666666666\n",
      "58300 loss=0.0957128781216366 accuracy=0.9713541666666666\n",
      "58400 loss=0.09036148106364605 accuracy=0.9739583333333334\n",
      "58500 loss=0.08092526266233174 accuracy=0.9765625\n",
      "58600 loss=0.08593598011300133 accuracy=0.9791666666666666\n",
      "58700 loss=0.09582127858755451 accuracy=0.9661458333333334\n",
      "58800 loss=0.08474661158444907 accuracy=0.9739583333333334\n",
      "58900 loss=0.08567726554369351 accuracy=0.9713541666666666\n",
      "59000 loss=0.0789087365638835 accuracy=0.984375\n",
      "59100 loss=0.10387333073758734 accuracy=0.9583333333333334\n",
      "59200 loss=0.090061155189789 accuracy=0.96875\n",
      "59300 loss=0.08581332238584438 accuracy=0.9739583333333334\n",
      "59400 loss=0.08060037869391845 accuracy=0.9895833333333334\n",
      "59500 loss=0.08404475416800714 accuracy=0.9713541666666666\n",
      "59600 loss=0.08075669432940089 accuracy=0.9765625\n",
      "59700 loss=0.08827077215317722 accuracy=0.9739583333333334\n",
      "59800 loss=0.09158247452668973 accuracy=0.984375\n",
      "59900 loss=0.09498827952254685 accuracy=0.96875\n",
      "epoch=59999 loss=0.07230257176370793 per_token_losses=tensor([0.0099, 0.0795, 0.1728, 0.0688, 0.0965, 0.0063], dtype=torch.float64) accuracy=0.9818 per_token_accuracy=array([1.      , 0.984375, 0.9375  , 1.      , 0.96875 , 1.      ])\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "9251b4d5abc94d94bdd3dd147f4f383b",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'hovertemplate': 'variable=0<br>index=%{x}<br>value=%{y}<extra></extra>',\n",
       "              'legendgroup': '0',\n",
       "              'line': {'color': '#636efa', 'dash': 'solid'},\n",
       "              'marker': {'symbol': 'circle'},\n",
       "              'mode': 'lines',\n",
       "              'name': '0',\n",
       "              'showlegend': True,\n",
       "              'type': 'scattergl',\n",
       "              'uid': '1adaf924-0485-4784-b1c9-88e03e50b081',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'xaxis': 'x',\n",
       "              'y': array([2.4348465 , 2.42998269, 2.44685267, ..., 0.08134259, 0.07519133,\n",
       "                          0.07230257]),\n",
       "              'yaxis': 'y'}],\n",
       "    'layout': {'legend': {'title': {'text': 'variable'}, 'tracegroupgap': 0},\n",
       "               'template': '...',\n",
       "               'title': {'text': 'train loss'},\n",
       "               'xaxis': {'anchor': 'y', 'domain': [0.0, 1.0], 'title': {'text': ''}},\n",
       "               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': ''}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "1829aa7002564566a22366ebfbdd5f5a",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'fb75669d-1494-449e-9d6c-f4150a04f2a6',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.56641025e+00, 2.52918130e+00, 2.56939767e+00, ..., 1.15360317e-04,\n",
       "                          1.83653998e-03, 9.91699805e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': '5da0580c-8e22-4aae-8a5f-23e8ef2093c1',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.50284896, 2.32718975, 2.52752096, ..., 0.06795238, 0.05241891,\n",
       "                          0.07949031])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'a620b4a8-51c9-4a52-8b5d-6ebbbef4ebcb',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.4277896 , 2.36361003, 2.40772135, ..., 0.14977019, 0.13174923,\n",
       "                          0.17284935])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': '01ecbabb-5711-4e75-abef-a295430a2cff',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.34406998, 2.48133836, 2.36436207, ..., 0.16447987, 0.16705264,\n",
       "                          0.06878829])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'cb4742d2-041e-4579-af12-b501c13e15bb',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.28323953, 2.41232144, 2.48976965, ..., 0.10224377, 0.09345889,\n",
       "                          0.0964645 ])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': '227962c2-e336-4afc-9b69-71700cb0633c',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.48472068, 2.46625528, 2.32234431, ..., 0.00349395, 0.00463177,\n",
       "                          0.00630597])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': '739ecc86-d2a0-4a39-885e-5ebc6b21111c',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': [2.4348465010350244, 2.429982693332567, 2.4468526677291154,\n",
       "                    ..., 0.08134258652727001, 0.07519133012917857,\n",
       "                    0.07230257176370793]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data)'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'Loss'}}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "3733a23450c64b888064a31a1c27fac2",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FigureWidget({\n",
       "    'data': [{'mode': 'lines',\n",
       "              'name': 'tok 0',\n",
       "              'type': 'scatter',\n",
       "              'uid': '51926cb4-fbf5-4919-b254-75139a887014',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.56641025e+00, 2.52918130e+00, 2.56939767e+00, ..., 1.15360317e-04,\n",
       "                          1.83653998e-03, 9.91699805e-03])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 1',\n",
       "              'type': 'scatter',\n",
       "              'uid': '8e8ab720-9572-4c46-b550-6527d2a5bd5c',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.50284896, 2.32718975, 2.52752096, ..., 0.06795238, 0.05241891,\n",
       "                          0.07949031])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 2',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'd0c32863-2823-4faf-9db1-e90faac4f411',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.4277896 , 2.36361003, 2.40772135, ..., 0.14977019, 0.13174923,\n",
       "                          0.17284935])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 3',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'f72c3d6e-bcf8-429f-9f66-c5a19dabf8b8',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.34406998, 2.48133836, 2.36436207, ..., 0.16447987, 0.16705264,\n",
       "                          0.06878829])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 4',\n",
       "              'type': 'scatter',\n",
       "              'uid': '09f06bf1-29b6-4ef6-9a2c-73ed84c85b0c',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.28323953, 2.41232144, 2.48976965, ..., 0.10224377, 0.09345889,\n",
       "                          0.0964645 ])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'tok 5',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'bfc37371-b4f3-4534-998a-ce820125dda3',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': array([2.48472068, 2.46625528, 2.32234431, ..., 0.00349395, 0.00463177,\n",
       "                          0.00630597])},\n",
       "             {'mode': 'lines',\n",
       "              'name': 'train_loss',\n",
       "              'type': 'scatter',\n",
       "              'uid': 'b26ad7b8-2530-4197-a3b1-cb3800a445f3',\n",
       "              'x': array([    0,     1,     2, ..., 59997, 59998, 59999]),\n",
       "              'y': [2.4348465010350244, 2.429982693332567, 2.4468526677291154,\n",
       "                    ..., 0.08134258652727001, 0.07519133012917857,\n",
       "                    0.07230257176370793]}],\n",
       "    'layout': {'template': '...',\n",
       "               'title': {'text': 'Per-digit Loss Curves for 5 digit addition (Infinite Data) - Log Y Axis'},\n",
       "               'xaxis': {'title': {'text': 'Step'}},\n",
       "               'yaxis': {'title': {'text': 'log Loss'}, 'type': 'log'}}\n",
       "})"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "train(is_finite=False, d_model=64, d_mlp=64, num_epochs=60_000, checkpoint_every=1000, seed = 134526)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba54e578-c091-4b32-b407-52bf90ee3431",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
